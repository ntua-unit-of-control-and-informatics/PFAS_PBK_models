Atissue = Aplas_free + AR + AKb + Afil + APTC + AL + AST + ASI 	#sum of mass in all compartments (ug)
Aloss = Aurine + Afeces #sum of mass lost through urinary and fecal excretion (ug)
Atotal = Atissue + Aloss 	#total mass; should equal total dose
list(c("dAR" = dAR, "dAdif" = dAdif, "dA_baso" = dA_baso, "dAKb" = dAKb,
"dACl" = dACl, "dAefflux" = dAefflux,
"dA_apical" = dA_apical, "dAPTC" = dAPTC, "dAfil" = dAfil,
"dAurine" = dAurine, "dAST" =dAST,
"dAabsST" = dAabsST, "dASI" = dASI, "dAabsSI" = dAabsSI, "dAfeces" = dAfeces,
"dAL" = dAL, "dAbile" = dAbile, "dAplas_free" = dAplas_free,
"dingestion" = dingestion),
"total_oral_uptake" = total_oral_uptake, "amount_per_gram_liver" = amount_per_gram_liver,
"Atissue" = Atissue, "Aloss" = Aloss, "Atotal" = Atotal, "CR" =CR, "CVR" = CVR, "CKb" = CKb,
"CVK" = CVK, "CPTC" = CPTC,
"Cfil" = Cfil, "CL" = CL, "CVL" = CVL, "CA_free" = CA_free, "CA" = CA,
"Cserum" = CA, "Cliver" = CL)
})
}
user_input <- list(
'sex' = "M",
"exposure_time" = seq(0,72,1),
"ingestion" = 10,
"ingestion_time" = 0,
"admin_dose" = 0,
"admin_time" = 0,
"admin_type" = "oral",
"exp_type" = "continuous",
"time_scale" = "hours"
)
run_worley <- function(user_input, solver = "lsodes", rtol = 1e-7, atol = 1e-7, seed = 1231){
params_worley <- sample.params.worley(user_input, seed = seed)
inits_worley <- create.inits.worley(params_worley)
events_worley <- create.events.worley(params_worley)
solution_worley <-  as.data.frame(deSolve::ode(times = user_input$exposure_time,
func = ode.func.worley,
y = inits_worley, parms = params_worley,
events = events_worley,
method= solver, rtol = rtol, atol = atol))
return(solution_worley)
}
N_samples <- 1000
res <- rep(NA, N_samples)
for (i in 1:N_samples){
solution_worley <- run_worley(user_input,seed = i)
res[i] <- solution_worley$Cliver[dim(solution_worley)[1]]
}
plot(density(res))
library(tidyr)
library(dplyr)
library(ggplot2)
seed = 345
res_pbk_bmd <- PfasDosim::reverse_dosimetry_pfoa(
BW = 70, sex = "F", duration = 72,
compartment = "serum", BMDL = 10, BMDU = 20,
PBK_probabilistic = TRUE, N_samples = 100,
seed = seed, optim_tol = 1e-3,
solver = "lsodes", rtol = 1e-4, atol = 1e-4,
verbose = FALSE
)
library(tidyr)
library(dplyr)
library(ggplot2)
seed = 345
res_pbk_bmd <- PfasDosim::reverse_dosimetry_pfoa(
BW = 70, sex = "F", duration = 72,
compartment = "serum", BMDL = 10, BMDU = 20,
PBK_probabilistic = TRUE, N_samples = 100,
seed = seed, optim_tol = 1e-3,
solver = "lsodes", rtol = 1e-4, atol = 1e-4,
verbose = FALSE
)
res_bmd_only <- PfasDosim::reverse_dosimetry_pfoa(
BW = 70, sex = "F", duration = 72,
compartment = "serum", BMDL = 10, BMDU = 20,
PBK_probabilistic = FALSE, N_samples = 100,
seed = seed, optim_tol = 1e-3,
solver = "lsodes", rtol = 1e-4, atol = 1e-4,
verbose = FALSE
)
# --- Combine to long format
df <- bind_rows(
tibble(exposure = res_pbk_bmd$exposure,
source   = "PBK + BMD variability"),
tibble(exposure = res_bmd_only$exposure,
source   = "BMD variability only")  # (fixed spelling)
)
# --- Medians for vlines
meds <- df |>
group_by(source) |>
summarise(median = median(exposure), .groups = "drop")
# --- Precompute densities PER GROUP (each on its own range)
dens_df <- df |>
group_by(source) |>
reframe({
de  <- density(exposure,)
tibble(x = de$x, density = de$y)
})
ggplot(dens_df, aes(x = x, y = density)) +
geom_area(aes(fill = source),
alpha = 0.30, colour = NA, position = "identity") +  # no stacking
geom_line(aes(colour = source), linewidth = 1) +               # crisp borders
geom_vline(data = meds, aes(xintercept = median, colour = source),
linetype = "dashed", linewidth = 0.8, inherit.aes = FALSE) +
labs(
title = "Probabilistic Reverse dosimetry for PFOA",
subtitle = "Comparison of PBK+BMD vs BMD-only variability",
x = "Estimated exposure (ng/kg/day)",
y = "Density",
fill = NULL, colour = NULL
) +
scale_x_continuous(
labels = scales::label_number(),
expand = expansion(mult = c(0, 0.05))  # no extra space on the left
) +
scale_y_continuous(
expand = expansion(mult = c(0, 0.05))  # no extra space below
) +
coord_cartesian(clip = "off") +
theme_classic(base_size = 13) +
theme(legend.position = "top", panel.grid.minor = element_line(colour = "grey90")) +
guides(fill = guide_legend(override.aes = list(alpha = 0.4)))
ggsave(paste0("Serum_BMDL = 10, BMDU = 20_hours",".png"),
device = 'png', dpi = 300,
width = 13,
height = 10,
units = "in")
f_tubular <- 0.52 # https://doi.org/10.1016/j.kint.2018.11.028, Proximal tubule cells account for roughly 52% of the estimated 206 million tubule epithelial cells per kidney.
#f_PTC_prot_to_tub_prot <- 0.6939
f_PTC_prot_to_total_prot <- 0.65 #https://doi.org/10.1681/ASN.2019040415
# For the section below, we assume that all measurement were made relative to rinsed organs that
# contained only capillary blood weight. Consequently, we multiply by the mass of the drained organ
MW = 414.07 #g/mol, PFOA molecular weight
intestine_protein <-109 #mg/g intestine. from van de Kerkhof (2007) [https://research.rug.nl/en/publications/drug-metabolism-in-human-and-rat-intestine-an-in-vitro-approach]
intestine_protein_total <- intestine_protein*(1000*fixed_params$MIn_drained) #mg
PTC_protein
f_tubular <- 0.52 # https://doi.org/10.1016/j.kint.2018.11.028, Proximal tubule cells account for roughly 52% of the estimated 206 million tubule epithelial cells per kidney.
#f_PTC_prot_to_tub_prot <- 0.6939
f_PTC_prot_to_total_prot <- 0.65 #https://doi.org/10.1681/ASN.2019040415
BW = 70
#volumes of filtrate compartments,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_2 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3
#volumes of filtrate compartments,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A# Loop of Henle
VDT <- 0.0194 # Distal tubule
VCD_1 <- 0.237 # Collecting duct segment 1
VCD_2 <- 0.237 # Collecting duct segment 2
VCD_3 <- 0.237 # Collecting duct segment 3
VCD_4 <- 0.237 # Collecting duct segment 4
VCD_5 <- 0.237 # Collecting duct segment 5
VCD_tot <- VCD_1 + VCD_2 + VCD_3 + VCD_4 + VCD_5
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap #kidney tissue volume kg=L
#Kidney
PVKi <- 0.44e-2 #Brown et al. 1997, Table 7
VKi_tot <- PVKi * BW #kidney volume kg=L
PVKiB <- 0.23 #PK-Sim
VKiB_cap <- PVKiB * PVKi * BW #kidney blood volume kg=L
PVKiF <- 0.20 #PK-Sim
VKiF <- PVKiF * PVKi * BW #kidney interstitial fluid volume kg=L
#volumes of filtrate compartments,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A# Loop of Henle
VDT <- 0.0194 # Distal tubule
VCD_1 <- 0.237 # Collecting duct segment 1
VCD_2 <- 0.237 # Collecting duct segment 2
VCD_3 <- 0.237 # Collecting duct segment 3
VCD_4 <- 0.237 # Collecting duct segment 4
VCD_5 <- 0.237 # Collecting duct segment 5
VCD_tot <- VCD_1 + VCD_2 + VCD_3 + VCD_4 + VCD_5
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap #kidney tissue volume kg=L
# Huang et al. (2018) [doi:10.1038/s41598-024-53270-2] (this is for RATS!)
# state that Table S1. The physiological volume of each tubular
# segment was calculated as a cylinder and physiological
# volume of the cellular compartment of each segment was assumed to be the same as the tubular volume
VPTC <- VPT_tot #for comparison, for 300g male rat we get 0.76mL and Worley and Fisher(2015) estimate 0.30 mL
VLHC <- VLH_tot
VDTC <- VDT
VCDC <- VCD_tot
VKTrest <- VKiT - VPTC - VLHC - VDTC - VCDC
VBladder <- 0.350 # L https://doi.org/10.1111/j.1742-1241.2011.02763.x
VKTrest
VCDC
VDTC
VLHC
VPTC
VKiT
VKi_tot
VPT_1
VPT_tot
VLH_tot
VFil
VKi_tot
BW
PVKi <- 0.44e-2 #Brown et al. 1997, Table 7
VKi_tot <- PVKi * BW #kidney volume kg=L
PVKiB <- 0.23 #PK-Sim
VKiB_cap <- PVKiB * PVKi * BW #kidney blood volume kg=L
PVKiF <- 0.20 #PK-Sim
VKiF <- PVKiF * PVKi * BW #kidney interstitial fluid volume kg=L
#volumes of filtrate compartments,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A # Loop of Henle
VDT_tot <- 0.0194 # Distal tubule
VCD_1 <- 0.237 # Collecting duct segment 1
VCD_2 <- 0.237 # Collecting duct segment 2
VCD_3 <- 0.237 # Collecting duct segment 3
VCD_4 <- 0.237 # Collecting duct segment 4
VCD_5 <- 0.237 # Collecting duct segment 5
VCD_tot <- VCD_1 + VCD_2 + VCD_3 + VCD_4 + VCD_5
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap #kidney tissue volume kg=L
# Huang et al. (2018) [doi:10.1002/psp4.12321]
# state that Table S1. The physiological volume of each tubular
# segment was calculated as a cylinder and physiological
# volume of the cellular compartment of each segment was assumed to be the same as the tubular volume
VPTC <- VPT_tot #for comparison, for 300g male rat we get 0.76mL and Worley and Fisher(2015) estimate 0.30 mL
VLHC <- VLH_tot
VDTC <- VDT_tot
VCDC <- VCD_tot
VKTrest <- VKiT - VPTC - VLHC - VDTC - VCDC
VKi_tot
VKiB_cap
VKiF
VPT_1
VFil
VKiT
VKTrest
VFil
VPT <- 2*pi*((0.03^2)*18*1e3
VPT <- 2*pi*(0.03^2)*18*1e3
VPT
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VPT_tot
VPT_tot
VLH_tot
VCD_tot
RCD <- 0.1 #mm
LCD <- 21 #mm
N_neph <- 6 #An average of six nephrons drains into a collecting duct.
tot_neph_per_CD <- 0.9*1e6 #0.9 millions
NCD <- N_neph/tot_neph_per_CD
VCD <- pi*(RCD^2)*LCD*NCD*1e-9
VCD
RCD
tot_neph_per_CD
NCD
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_neph <- 0.9*1e6 #0.9 millions
NCD <- N_neph/tot_neph_per_CD
VCD <- pi*(RCD^2)*LCD*NCD*1e-9 #L
VCD
#Kidney
PVKi <- 0.44e-2 #Brown et al. 1997, Table 7
VKi_tot <- PVKi * BW #kidney volume kg=L
PVKiB <- 0.23 #PK-Sim
VKiB_cap <- PVKiB * PVKi * BW #kidney blood volume kg=L
PVKiF <- 0.20 #PK-Sim
VKiF <- PVKiF * PVKi * BW #kidney interstitial fluid volume kg=L
#volumes of filtrate compartments,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A # Loop of Henle
VDT_tot <- 0.0194 # Distal tubule
# he table multiplies every segment by the nephron count,
# which is not fine for the collecting duct (CD), because CDs are a branching tree shared by many nephrons, #https://doi.org/10.1016/B978-0-12-391448-4.00011-3
# calculations for collecting duct scaling the collecting duct by a branching factor
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_neph <- 0.9*1e6 #0.9 millions
NCD <- N_neph/tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*NCD*1e-9 #L
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap
VKiT
VFil
VCD_tot
VDT_tot
VLH_tot
# which is not fine for the collecting duct (CD), because CDs are a branching tree shared by many nephrons, #https://doi.org/10.1016/B978-0-12-391448-4.00011-3
# calculations for collecting duct scaling the collecting duct by a branching factor
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 20*2 # 20 collecting ducts per kidney
N_neph <- 0.9*1e6*2 # 0.9 millions per kidney
VCD_tot <- pi*(RCD^2)*LCD*N_CD*tot_neph_per_CD*1e-9 #L
VCD_tot
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 20*2 # 20 collecting ducts per kidney
N_neph_tot <- 0.9*1e6*2 # 0.9 millions per kidney
CD_neph <- N_CD * tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*CD_neph*1e-6 #L
VCD_tot
VLH_tot
#volumes of filtrate compartments for total of two kidneys,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A # Loop of Henle
VDT_tot <- 0.0194 # Distal tubule
# he table multiplies every segment by the nephron count,
# which is not fine for the collecting duct (CD), because CDs are a branching tree shared by many nephrons, #https://doi.org/10.1016/B978-0-12-391448-4.00011-3
# calculations for collecting duct scaling the collecting duct by a branching factor
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 20*2 # 20 collecting ducts per kidney
CD_neph <- N_CD * tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*CD_neph*1e-6 #L
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
VPT_tot
VLH_tot
VDT_tot
VCD_tot
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A # Loop of Henle
VDT_tot <- 0.0194 # Distal tubule
# he table multiplies every segment by the nephron count,
# which is not fine for the collecting duct (CD), because CDs are a branching tree shared by many nephrons, #https://doi.org/10.1016/B978-0-12-391448-4.00011-3
# calculations for collecting duct scaling the collecting duct by a branching factor
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 200*2 # 20 collecting ducts per kidney
CD_neph <- N_CD * tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*CD_neph*1e-6 #L
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
VCD_tot
VDT_tot
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 200*2 # 20 collecting ducts per kidney
CD_neph <- N_CD * tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*CD_neph*1e-6 #L
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap #kidney tissue volume kg=L
# Huang et al. (2018) [doi:10.1002/psp4.12321]
# state that Table S1. The physiological volume of each tubular
# segment was calculated as a cylinder and physiological
# volume of the cellular compartment of each segment was assumed to be the same as the tubular volume
VPTC <- VPT_tot #for comparison, for 300g male rat we get 0.76mL and Worley and Fisher(2015) estimate 0.30 mL
VLHC <- VLH_tot
VDTC <- VDT_tot
VCDC <- VCD_tot
VKTrest <- VKiT - VPTC - VLHC - VDTC - VCDC
VKTrest
VCD_tot
#volumes of filtrate compartments for total of two kidneys,[L] https://doi.org/10.1002/psp4.12321
VPT_1 <- 0.0305 # Proximal tubule segment 1
VPT_2 <- 0.0305 # Proximal tubule segment 2
VPT_3 <- 0.0305 # Proximal tubule segment 3
VPT_tot <- VPT_1 + VPT_2 + VPT_3 # Proximal tubule
VLH_D <- 0.0027 # Loop of Henle, descending segment
VLH_A <- 0.0027 # Loop of Henle, ascending segment
VLH_tot <- VLH_D + VLH_A # Loop of Henle
VDT_tot <- 0.0194 # Distal tubule
# he table multiplies every segment by the nephron count,
# which is not fine for the collecting duct (CD), because CDs are a branching tree shared by many nephrons, #https://doi.org/10.1016/B978-0-12-391448-4.00011-3
# calculations for collecting duct scaling the collecting duct by a branching factor
RCD <- 0.1 #mm
LCD <- 21 #mm
tot_neph_per_CD <- 6 #An average of six nephrons drains into a collecting duct.
N_CD <- 20*2 # 20 collecting ducts per kidney
CD_neph <- N_CD * tot_neph_per_CD
VCD_tot <- pi*(RCD^2)*LCD*CD_neph*1e-6 #L
VFil <-  VPT_tot + VLH_tot + VDT + VCD_tot #L
# We hypothesize that when kidney is weighted the renal tubule content remains inside
VKiT <- VKi_tot - VKiF - VFil - VKiB_cap #kidney tissue volume kg=L
# Huang et al. (2018) [doi:10.1002/psp4.12321]
# state that Table S1. The physiological volume of each tubular
# segment was calculated as a cylinder and physiological
# volume of the cellular compartment of each segment was assumed to be the same as the tubular volume
VPTC <- VPT_tot #for comparison, for 300g male rat we get 0.76mL and Worley and Fisher(2015) estimate 0.30 mL
VLHC <- VLH_tot
VDTC <- VDT_tot
VCDC <- VCD_tot
VKTrest <- VKiT - VPTC - VLHC - VDTC - VCDC
VBladder <- 0.350 # L https://doi.org/10.1111/j.1742-1241.2011.02763.x
VKTrest
VKiT
VPTC
VLHC
VDTC
VCDC
VKi_tot
VPT_tot
VKiF
VFil
VKiB_cap
VKiF+VFil+VKiB_cap
VKiT
APT_1 <- 6107*1e-2 # Proximal tubule segment 1
APT_2 <- 6107*1e-2  # Proximal tubule segment 2
APT_3 <- 6107*1e-2  # Proximal tubule segment 3
APT_tot <- APT_1 + APT_2 + APT_3 # Proximal tubule
ALH_D <- 61*1e-2  # Loop of Henle, descending segment
ALH_A <- 61*1e-2  # Loop of Henle, ascending segment
ALH_tot <- ALH_D + ALH_A # Loop of Henle
ADT_tot <- 156*1e-2  # Distal tubule
ACD_1 <- 6.7*1e-2 # Collecting duct segment 1
ACD_2 <- 6.7*1e-2 # Collecting duct segment 2
ACD_3 <- 6.7*1e-2 # Collecting duct segment 3
ACD_4 <- 6.7*1e-2 # Collecting duct segment 4
ACD_5 <- 6.7*1e-2 # Collecting duct segment 5
ACD_tot <- ACD_1 + ACD_2 + ACD_3 + ACD_4 + ACD_5
AFil <-  APT_tot + ALH_tot + ADT_tot + ACD_tot #L
ACD_tot
ADT_tot
ALH_tot
ALH_A
ALH_D
APT_tot
AFil
QPT_1 <- 120*1e-3*60 # Proximal tubule segment 1
QPT_2 <- 94*1e-3*60  # Proximal tubule segment 2
QPT_3 <- 68*1e-3*60  # Proximal tubule segment 3
QPT_tot <- QPT_1 + QPT_2 + QPT_3 # Proximal tubule
QLH_D <- 43*1e-3*60  # Loop of Henle, descending segment
QLH_Q <- 24*1e-3*60  # Loop of Henle, ascending segment
QLH_tot <- QLH_D + QLH_Q # Loop of Henle
QDT_tot <- 24*1e-3*60  # Distal tubule
QCD_1 <- 11*1e-3*60 # Collecting duct segment 1
QCD_2 <- 9*1e-3*60 # Collecting duct segment 2
QCD_3 <- 7*1e-3*60 # Collecting duct segment 3
QCD_4 <- 5*1e-3*60 # Collecting duct segment 4
QCD_5 <- 3*1e-3*60 # Collecting duct segment 5
QCD_tot <- QCD_1 + QCD_2 + QCD_3 + QCD_4 + QCD_5
QCD_tot
QDT_tot
QLH_tot
QPT_tot
sex == "M"
sex <- M
sex <- "M"
if (sex == "M"){
PQGFR <- 62.1  #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_drained #L/h
Qurine <- (60/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}else if(sex == "F"){
PQGFR <- 41.04 #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_drained #L/h
Qurine <- (85/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}
if (sex == "M"){
PQGFR <- 62.1  #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_tot #L/h
Qurine <- (60/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}else if(sex == "F"){
PQGFR <- 41.04 #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_tot#L/h
Qurine <- (85/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}
QGE<- 1.4*BW^(-0.25) #gastric emptying time [1/(h/BW^(-0.25)]*BW^(-0.25)--> [1/h]. From Yang et al. (2013) [doi: 10.1016/j.taap.2013.03.022]
QGFR
QPT_tot
VKi_tot
APT_tot
AFil
(7+10)/2
d_peritubular <- 25.9 # PTCs per tubular surface area (PTC/50,000 μm2)
PTC_diameter <- 8.5 #μm, assumption
PTC_Mean_capillary_length <- 75 #μm, assumption
A_PTC_mean <- pi*PTC_diameter*PTC_Mean_capillary_length
N_PTC_total <- d_peritubular * (AFil * 1e12 / 50000)
A_peritubular <- N_PTC_total * A_PTC_mean * 1e-12   # m2
A_peritubular
(8+21)/2
