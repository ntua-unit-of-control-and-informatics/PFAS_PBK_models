MIn_drained <- VIn_drained * d_int
fcap_in <- 0.010 # from Bernareggi and  Rowland (1991)
VInB_cap <- fcap_in * MIn_drained
PVInB <- 0.024   # from  Kawai et al. (1994)
VIn_tot <- (VIn_drained - VInB_cap) / (1 - PVInB)
MIn <- (VIn_drained - VInB_cap) * d_int
VInB <- PVInB * VIn_tot
fcap_to_blood_in<-  VInB_cap/VInB
PVInF <- 0.094 #from Kawai et al. (1994)
VInF <- PVInF * (VIn_drained - VInB_cap)
VInT <- VIn_drained - VInF - VInB_cap
VInB_lv <- VInB - VInB_cap
# Stomach
PVSt <- 0.46e-2 #from Brown et al. (1997)
d_stomach <- 1.05 #from Brown et al. (1997)
VSt_drained <- PVSt * BW / d_stomach
MSt_drained <- VSt_drained * d_stomach
fcap_st <- 0.011 # from Bernareggi and  Rowland (1991)
VStB_cap <- fcap_st * MSt_drained
PVStB <- 0.032 #from  Kawai et al. (1994)
VSt_tot <- (VSt_drained - VStB_cap) / (1 - PVStB)
MSt <-  (VSt_drained - VStB_cap)* d_stomach
VStB <- PVStB * VSt_tot
fcap_to_blood_st<-  VStB_cap/VStB
PVStF <- 0.10 #from  Kawai et al. (1994)
VStF <- PVStF * (VSt_drained - VStB_cap)
VStT <- VSt_drained - VStF - VStB_cap
VStB_lv <- VStB - VStB_cap
#Stomach and intestine lumen
# The values below are from Conell et al. (2008) [doi: 10.1211/jpp.60.1.0008] and represent measured average water content of fed and fasted state from Figure 4.
PVStL <- 0.53/175 #mL/g BW
VStL <- PVStL * BW
PVInL <- (5.4- 0.53)/175 # mL/g BW
VInL <- PVInL * BW
# Muscle
PVMu <- 40.43e-2 #from Brown et al. (1997)
d_muscle <- 1.04 #from Brown et al. (1997)
VMu_drained <- PVMu * BW / d_muscle
fcap_mu <- 0.004 # from Bernareggi and  Rowland (1991)
VMuB_cap <- fcap_mu * VMu_drained* d_muscle
PVMuB <- 0.04 #from  Brown et al. (1997)
VMu_tot <- (VMu_drained - VMuB_cap) / (1 - PVMuB)
MMu <- (VMu_drained - VMuB_cap)  * d_muscle
VMuB <- PVMuB * VMu_tot
fcap_to_blood_mu <-  VMuB_cap/VMuB
PVMuF <- 0.120 #from  Kawai et al. (1994)
VMuF <- PVMuF * (VMu_drained - VMuB_cap)
VMuT <- VMu_drained - VMuF - VMuB_cap
VMuB_lv <- VMuB - VMuB_cap
# Adipose
PVAd <- mean(c(5.5,7))*1e-2 #from Brown et al. (1997)
d_adipose <- 0.92    # from Brown et al. (1997)
VAd_drained <- PVAd * BW / d_adipose
fcap_ad <- 0.005 #from Bernareggi and  Rowland (1991)
VAdB_cap <- fcap_ad * VAd_drained * d_adipose
PVAdB <- 0.01 #from  Kawai et al. (1994)
VAd_tot <- (VAd_drained - VAdB_cap) / (1 - PVAdB)
MAd <- (VAd_drained - VAdB_cap) * d_adipose
VAdB <- PVAdB * VAd_tot
fcap_to_blood_ad<-  VAdB_cap/VAdB
PVAdF <- 0.135 #from  Kawai et al. (1994)
VAdF <- PVAdF * (VAd_drained - VAdB_cap)
VAdT <- VAd_drained - VAdF - VAdB_cap
VAdB_lv <- VAdB - VAdB_cap
# Lung
PVLu <- 0.50e-2 #from Brown et al. (1997)
d_lung <- 1.05 #from Brown et al. (1997)
VLu_drained <- PVLu * BW / d_lung
MLu_drained <- VLu_drained * d_lung
fcap_lu <- 0.175 #from  Bernareggi and  Rowland (1991)
VLuB_cap <- fcap_lu *MLu_drained
PVLuB <- 0.36  #from  Brown et al. (1997)
VLu_tot <- (VLu_drained - VLuB_cap) / (1 - PVLuB)
MLu <- (VLu_drained - VLuB_cap) * d_lung
VLuB <- PVLuB * VLu_tot
fcap_to_blood_lu<-  VLuB_cap/VLuB
PVLuF <- 0.188 #from  Kawai et al. (1994)
VLuF <- PVLuF * (VLu_drained - VLuB_cap)
VLuAF <- ((0.014+0.018)/2)/((335 + 290)/2) * BW # from Boger et al, 2023 [doi: 10.1016/j.xphs.2023.01.001]
VLuT <- VLu_drained - VLuF - VLuAF - VLuB_cap
VLuB_lv <- VLuB - VLuB_cap
#  For the spleen assume that all of the blood is capillary blood and thus we use the value of total blood from Brown et al. (1997),
# as capillary blood, because the value of residual blood after bleeding from  Bernareggi and  Rowland (1991) was higher.
PVSp <- 0.2e-2 # from Brown et al. (1997)
d_spleen <- 1.05  # from Brown et al. (1997)
VSp_drained <- PVSp * BW / d_spleen
PVSpB <- 0.22 #from Brown et al. (1997)
fcap_sp <- PVSpB
VSpB_cap <- fcap_sp * VSp_drained * d_spleen
VSp_tot <- VSp_drained
MSp <- (VSp_drained-VSpB_cap)*d_spleen
VSpB <- VSpB_cap
fcap_to_blood_sp<-  VSpB_cap/VSpB
PVSpF <- 0.150 #from  Kawai et al. (1994)
VSpF <- PVSpF * (VSp_drained - VSpB_cap)
VSpT <- VSp_drained - VSpF - VSpB_cap
VSpB_lv <- 0
# Heart
PVHt <- 0.33e-2  #Brown et al. (1997)
d_heart <- 1.03  #Brown et al. (1997)
VHt_drained <- PVHt * BW / d_heart
fcap_ht <- 0.061  #from  Bernareggi and  Rowland (1991)
VHtB_cap <- fcap_ht * VHt_drained * d_heart
PVHtB <- 0.26  #Brown et al. (1997)
VHt_tot <- (VHt_drained - VHtB_cap) / (1 - PVHtB)
MHt <- (VHt_drained - VHtB_cap)*d_heart
VHtB <- PVHtB * VHt_tot
fcap_to_blood_ht <-  VHtB_cap/VHtB
PVHtF <- 0.10 #from  Kawai et al. (1994)
VHtF <- PVHtF * (VHt_drained - VHtB_cap)
VHtT <- VHt_drained - VHtF - VHtB_cap
VHtB_lv <- VHtB - VHtB_cap
# Brain
PVBr <- 0.57e-2  #Brown et al. (1997)
d_brain <- 1.035
VBr_drained <- PVBr * BW / d_brain
fcap_br <- 0.014  #from  Bernareggi and  Rowland (1991)
VBrB_cap <- fcap_br * VBr_drained * d_brain
PVBrB <- 0.03  #Brown et al. (1997)
VBr_tot <- (VBr_drained - VBrB_cap) / (1 - PVBrB)
MBr <- (VBr_drained - VBrB_cap) * d_brain
VBrB <- PVBrB * VBr_tot
fcap_to_blood_br <-  VBrB_cap/VBrB
PVBrF <- 0.004 #from  Kawai et al. (1994).
VBrF <- PVBrF * (VBr_drained - VBrB_cap)
VBrT <- VBr_drained - VBrF - VBrB_cap
VBrB_lv <- VBrB - VBrB_cap
# Gonads
PVGo <- 0.25e-2/0.230 #from PK-Sim
d_gonads <- 1.05 #assumption
VGo_drained <- PVGo * BW / d_gonads
fcap_go <- 0.007  # value for testis, from  Bernareggi and  Rowland (1991)
VGoB_cap <- fcap_go * VGo_drained * d_gonads
PVGoB <- 0.14 #from PK-Sim
VGo_tot <- (VGo_drained - VGoB_cap) / (1 - PVGoB)
MGo <- (VGo_drained - VGoB_cap) * d_gonads
VGoB <- PVGoB * VGo_tot
fcap_to_blood_go <-  VGoB_cap/VGoB
PVGoF <- 0.07 #from PK-Sim
VGoF <- PVGoF * (VGo_drained - VGoB_cap)
VGoT <- VGo_drained - VGoF - VGoB_cap
VGoB_lv <- VGoB - VGoB_cap
# Skin
PVSk <- 19.03e-2  #Brown et al. (1997)
d_skin <- 1.12 #density of dermis. From Brown et al. (1997)
VSk_drained <- PVSk * BW / d_skin
fcap_sk <- 0.002 #from  Bernareggi and  Rowland (1991)
VSkB_cap <- fcap_sk * VSk_drained * d_skin
PVSkB <- 0.02  #Brown et al. (1997)
VSk_tot <- (VSk_drained - VSkB_cap) / (1 - PVSkB)
MSk <-  (VSk_drained - VSkB_cap)*d_skin
VSkB <- PVSkB * VSk_tot
fcap_to_blood_sk <-  VSkB_cap/VSkB
PVSkF <- 0.3 # from  Kawai et al. (1994). Wiig and Ree (1981) report a similar value (0.4) #[doi: 10.1111/j.1748-1716.1981.tb06901.x] 40 mL/100 g tissue, BW = 200-250 g
VSkF <- PVSkF * (VSk_drained - VSkB_cap)
VSkT <- VSk_drained - VSkF - VSkB_cap
VSkB_lv <- VSkB - VSkB_cap
# Bones
PVBo <- mean(c(5,7))*1e-2  #from Brown et al. (1997)
d_bone <- 1.96  #average of trabecular and cortical. From Brown et al. (1997)
VBo_drained <- PVBo * BW / d_bone
fcap_bo <- 0.019   #from  Bernareggi and  Rowland (1991)
VBoB_cap <- fcap_bo * VBo_drained * d_bone
PVBoB <- 0.04  #Brown et al. (1997)
VBo_tot <- (VBo_drained - VBoB_cap) / (1 - PVBoB)
MBo <- (VBo_drained - VBoB_cap) * d_bone
VBoB <- PVBoB * VBo_tot
fcap_to_blood_bo <-  VBoB_cap/VBoB
PVBoF <- 0.10 # from  Kawai et al. (1994).
VBoF <- PVBoF * (VBo_drained - VBoB_cap)
VBoT <- VBo_drained - VBoF - VBoB_cap
VBoB_lv <- VBoB - VBoB_cap
Mtissue_tot <- MK +  MLi + MIn + MSt +  MMu + MAd + MLu + MSp + MHt + MBr + MGo + MSk + MBo #[kg] total tissue mass without the RoB (and with no blood)
Mlumen <- 1*VInL + 1*VStL #kg
VBlood <- (0.06 * BW *1000+ 0.77)/1000    # Total blood. From Lee and Blaufox (1981) [PMID: 3965655]
#Rest-of-the-body (re) !!!!!
MR_tot <- BW - Mtissue_tot - 1*VBlood - Mlumen
d_re <- 1.05 # assumption
VRe_tot <- MR_tot/d_re
PVReB <- (PVKiB+PVLiB+PVLuB+PVMuB+PVAdB+PVSpB+PVHtB+PVBrB+PVGoB+PVStB+PVInB+PVSkB+PVBoB)/13 #average fraction of all the included organs
VReB <- PVReB *VRe_tot
fcap_to_blood_re <- (fcap_to_blood_ki + fcap_to_blood_li + fcap_to_blood_in + fcap_to_blood_st + fcap_to_blood_mu + fcap_to_blood_ad + fcap_to_blood_lu +
fcap_to_blood_sp + fcap_to_blood_ht + fcap_to_blood_br + fcap_to_blood_go + fcap_to_blood_sk + fcap_to_blood_bo)/13
VReB_cap <- fcap_to_blood_re*VReB
VRe_drained <- VRe_tot - VReB + VReB_cap
PVReF <-(PVKF+PVLiF+PVLuF+PVMuF+PVAdF+PVSpF+PVHtF+PVBrF+PVGoF+PVStF+PVInF+PVSkF+PVBoF)/13 #average interstitial fraction of all the included organs
VReF <- PVReF * (VRe_drained -VReB_cap)
VReT <- VRe_drained - VReF - VReB_cap
VReB_lv <- VReB - VReB_cap
Vcap_tot <-  VKiB_cap + VLiB_cap + VInB_cap + VStB_cap + VMuB_cap + VAdB_cap + VLuB_cap + VSpB_cap + VHtB_cap + VBrB_cap +
VGoB_cap + VSkB_cap + VBoB_cap +  VReB_cap
VB_central <- VBlood - Vcap_tot # blood not in capillaries
f_ven <- 3/4 #from Brown et al. (1997)
f_art <- 1/4 #from Brown et al. (1997)
VVen <- f_ven *VB_central 	#volume of venous blood. From Kawai et al. (1994) [doi:10.1007/bf02353860]
VArt <- f_art *VB_central 	#volume of arterial blood.  From Kawai et al. (1994)
#-------------------------------------------------------------------------------------------------
#----------------------------       Surface Areas       ------------------------------------------
#-------------------------------------------------------------------------------------------------
# For scaling capillary surface area we use simple linear scaling
# while for interstitial-intracellular surface area we scale with body weight to the 3/4,
# following PK-Sim
BW_ref <- 0.23
linear_scaling_factor <- BW/BW_ref
nonlinear_scaling_factor <- (BW/BW_ref)^0.75
##Capillary surface area for each tissue (Ai)(m^2),
#Peritubular capillary density in From Gazzard et al. (2024) [doi: 10.1002/ar.25576]
d_peritubular <- 0.024 #um^2/um^3,
VK_gazzard <- 0.00363#L
Vcortex <- 2*1295* VKi_tot/VK_gazzard #mm^3,
A_peritubular <- (d_peritubular*Vcortex*1e3/1e6) #m^2
# The following values from PK-Sim "Endothelial Surface area", Niederalt et al., 2018, [doi: 10.1007/s10928-017-9559-4]
PAL <- 1136e-4 #m^2
AL <- PAL *  linear_scaling_factor #liver surface area (m^2)
PAST <- 33.77e-4 #m^2
AST <- PAST * linear_scaling_factor #stomach surface area (m^2)
PAIN <- (74.82e-4+20.6e-4) #m^2 #large and small intestine
AIN <- PAIN * linear_scaling_factor #intestine surface area (m^2)
PAM <- 3043e-4 #m2
AM <- PAM * linear_scaling_factor #muscle surface area (m^2)
PAA <- 95.93e-4/0.23 #m2
AA <- PAA * linear_scaling_factor #adipose surface area (m^2)
PAR <- 100e-4#m^2, assumption
AR <- PAR * linear_scaling_factor #surface area of rest of body (m^2)
PLu <- 600.5e-4 #m^2
ALu <- PLu * linear_scaling_factor #lung surface area (m^2)
PSP <- 162.3e-4 #m^2
ASP <- PSP * linear_scaling_factor #spleen surface area (m^2)
PH <-  201.1e-4 #m^2
AH <- PH * linear_scaling_factor #heart surface area (m^2)
PBr <- 60.34e-4 #m^2
ABr <- PBr * linear_scaling_factor #brain surface area (m^2)
PGo <- 335.8e-4#m^2
AGo <- PGo * linear_scaling_factor #gonads surface area (m^2)
PSK <- 729.1e-4#m^2
ASK <- PSK * linear_scaling_factor #skin surface area (m^2)
PBo <- 621.4e-4#m^2
ABo <- PBo * linear_scaling_factor #bones surface area (m^2)
# Gut surface areas from PK-Sim
Duodenum <- 5.50 #cm^2
Upper_jejunum <- 27.33 #cm^2
Lower_jejunum <- 27.33 #cm^2
Upper_ileum <- 0.82 #cm^2
Lower_ileum <- 0.59 #cm^2
Cecum <- 1.63 #cm^2
colon_ascendens <- 6.36 #cm^2
colon_transversum <- 3.22 #cm^2
colon_descendens <-2.27 #cm^2
colon_sigmoid <-2.14 #cm^2
SA_PKSim <- Duodenum+Upper_jejunum+Lower_jejunum+Upper_ileum+Lower_ileum+Cecum+
colon_ascendens+colon_transversum+colon_descendens+colon_sigmoid
#Enhancement factors
EF_Duodenum <- 13.86
EF_Upper_jejunum <-10.68
EF_Lower_jejunum <- 8.31
EF_Upper_ileum <- 8.11
EF_Lower_ileum <- 11.22
EF_Cecum <- 1.47
EF_colon_ascendens <- 1.7
EF_colon_transversum <- 1.92
EF_colon_descendens <- 1.95
EF_colon_sigmoid <- 1.95
SA_PKSim_effective <- (Duodenum*EF_Duodenum+Upper_jejunum*EF_Upper_jejunum+Lower_jejunum*EF_Lower_jejunum+
Upper_ileum*EF_Upper_ileum+Lower_ileum*EF_Lower_ileum+Cecum*EF_Cecum+
colon_ascendens*EF_colon_ascendens+colon_transversum*EF_colon_transversum+
colon_descendens*EF_colon_descendens+colon_sigmoid*EF_colon_sigmoid)
AINL <- SA_PKSim_effective * 1e-4 #m^2, no body weight scaling
#Surface areas Interstitial - Intracellular (m^2), from PK-Sim
BW_ref <- 0.23/1e4
AcK_total= 437.16*nonlinear_scaling_factor
# for renal tubule, we assume that the total surface area is split proportionally to the volume of each segment.
AcK_PTC <- AcK_total*VPTC/VFil # surface area of proximal tubule cells
AcK_DALC <- AcK_total*VDALC/VFil # surface area of decending/ascending limb cells (loop of Henle)
AcK_DTC <- AcK_total*VDTC/VFil # surface area of distal tubule cells
AcK_CDC <- AcK_total*VCDC/VFil # surface area of collecting duct cells
AcKTrest <- AcK_total* VKTrest/VFil
AcL= 84.45*nonlinear_scaling_factor
AcST= 1007.31*nonlinear_scaling_factor
AcIN= (400.94+152.39) *nonlinear_scaling_factor # small+large intestine
AcM= 8.2*nonlinear_scaling_factor
AcA= 3.87*nonlinear_scaling_factor
AcLu= 0.05*nonlinear_scaling_factor
AcSP= 564.05*nonlinear_scaling_factor
AcH= 5.60*nonlinear_scaling_factor
AcBr= 6.12e-4*nonlinear_scaling_factor
AcGo= 2.01*nonlinear_scaling_factor
AcSK= 0.11*nonlinear_scaling_factor
AcBo= 6.52*nonlinear_scaling_factor
# We don't have data for the surface area of IS-IC for the rest of the body, thus
# we naively assume an average:
AcR= median(c(AcK_total,AcL,AcST,AcIN,AcM,AcA,AcLu,AcSP,AcH,AcBr,AcGo,AcSK,AcBo))
n <- 5 #enlargement factor of the apical membrane of tubule cells
# Surface areas of the different subcompartments of kidney filtrate, m^2
APT <-  2*pi*(RPT_slp*LPT_slp + RPT_llp*LPT_llp)*n # Proximal tubule (short- and long-looped)
ATDL <- 2*pi*(RTDL_slp*LTDL_slp + RTDL_llp*LTDL_llp)*n #Thin descending limb (short- and long-looped)
AThinAL <-  2*pi*RThinAL*LThinAL*n #Thin ascending limb (long-looped)
AThickAL <- 2*pi*(RThickAL_cort*LThickAL_cort + RThickAL_med*LThickAL_med)*n #Thick ascending limb (Cortical and Medullary)
ADAL <- ATDL + AThinAL + AThickAL
ADT <- 2*pi*(RDT_sup*LDT_sup + RDT_deep*LDT_deep)*n #Distal tubule (superficial+deep)
ACD <- 2*pi*(Rduct_cort*Lduct_cort + Rduct_med*Lduct_med)*n #collecting duct (Cortical+Outer)
AFil <- APT + ADAL + ADT + ACD
#Alveolar cells surface area, m^2
AcALF = 0.4* (BW/0.363)  #Stone et al., 1992 [doi:10.1165/ajrcmb/6.2.235]
#----------------------------------------------------------------------------------------------
#-------------------------             Flow Rates           -----------------------------------
#----------------------------------------------------------------------------------------------
########
#Blood flow rates
###
#(QBi, in L/h) to different tissues expressed using the corresponding percentage of cardiac output
Qcardiac <- 0.235 * (BW^0.75) *60 #[L/h]
PQBK <- 14.1/100 #Brown et al. 1997, p 438, Table 23
QBK <- PQBK * Qcardiac #L/h
PQBL <- 2.4/100
QBL <- PQBL * Qcardiac #L/h Brown et al. 1997, p 438, Table 23
PQBST <- 0.16/100 #[doi: 10.3390/pharmaceutics6010097] Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBST = (8/1000)/Qcard
QBST <- PQBST * Qcardiac #L/h
PQBIN <- 9.1/100 #[doi: 10.3390/pharmaceutics6010097] Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBIN = (451/1000)/Qcard
QBIN <- PQBIN * Qcardiac #L/h
PQBM <- 27.8/100 #Brown et al. 1997, p 438, Table 23
QBM <- PQBM * Qcardiac #L/h
PQBA <- 7/100 #Brown et al. 1997, p 438, Table 23
QBA <- PQBA * Qcardiac #L/h
PQBLu <- 1
QBLu <- PQBLu * Qcardiac #L/h
PQBSP <- 0.76/100 #[doi: 10.3390/pharmaceutics6010097] Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBSP = (37.8/1000)/Qcard
QBSP <- PQBSP * Qcardiac #L/h
PQBH <- 4.9/100 #Brown et al. 1997, p 438, Table 23
QBH <- PQBH * Qcardiac #L/h
PQBBr <- 2.0/100 #Brown et al. 1997, p 438, Table 23
QBBr <- PQBBr * Qcardiac #L/h
PQBGo <- 1.04/100 #[doi: 10.1152/ajpregu.1987.253.2.R228]. Vgon =(0.25e-2/0.230)*335 [g]  Qgon = 60*(0.295/1000)*Vgon [L/h],  fraction:f_gon=  Qgon/Qcard
QBGo <- PQBGo * Qcardiac #L/h
PQBSK <- 5.8/100 # Brown et al. (1997)
QBSK <- PQBSK * Qcardiac #L/h
PBBo <- 12.2/100 #Brown et al. 1997, p 438, Table 23
QBBo <- PBBo * Qcardiac #L/h
# Total blood outflow from liver
QBLtot <- QBL+QBSP+QBIN+QBST
PQBR = 1 - PQBK - PQBL - PQBST - PQBIN - PQBM - PQBA - PQBH - PQBSK - PQBSP - PQBGo - PQBBr - PBBo
QBR <- PQBR * Qcardiac #L/h
#########
#     Other fluids flow rates
###
#Flow rate of fluids including feces, bile, urine and glomerular filtration rate (GFR), in L/h
#PQbile <- 90/1000/24 # [mL/d/kg BW]/1000/24 --> L/h/kg BW
#Qbile <- PQbile * BW #L/h
if (sex == "M"){
PQbile = 0.206/2 #L/kg liver/h. The study uses male rats. From  Prasnicka et al. (2018) [doi: 10.1038/s41598-019-46150-7]
Qbile = PQbile* VLi_drained  #L/h
}else if (sex == "F"){
# Females have 44% more bile flow. From Vonk et al. (1978) [doi:10.1042/cs0550253]
PQbile = 0.206/2 #L/kg liver/h #
Qbile = 1.44* PQbile* VLi_drained  #L/h
}
Qfeces <- (8.18/0.21)*BW/24/1000 #g/kg BW, based on Cui et al.(2010)
feces_density <- 1.29 #g/cm^3 --> g/mL from Lupton 1986, Fig 1. Fiber free control diet, [doi: 10.1093/jn/116.1.164]
if (sex == "M"){
PQGFR <- 62.1  #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_drained #L/h
Qurine <- (60/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}else if(sex == "F"){
PQGFR <- 41.04 #L/h/kg kidney. From Corley et al., 2005 [doi: 10.1093/toxsci/kfi119]
QGFR <- PQGFR * VKi_drained #L/h
Qurine <- (85/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, [doi: 10.1002/nau.1006]
}
QGE<- 1.4*BW^(-0.25) #gastric emptying time [1/(h/BW^(-0.25)]*BW^(-0.25)--> [1/h]. From Yang et al. (2013) [doi: 10.1016/j.taap.2013.03.022]
#flows of filtrate compartments from Gilmer et al. (2018) [doi: 10.1152/ajprenal.00219.2018]
# The values represent flow rates at the beginning of individual segments
# Units: [nL/min]*2*1e-9*60 ---> L/h
QPT_ref <- (40.9*26980+39.7*11020)*2*1e-9*60 #L/h, proximal tubule flow (short +long)
QTDL_ref <- (26.4*26980+26.3*11020)*2*1e-9*60 #L/h, Thin descending limb (short +long)
QTAL_ref <- 8 * 38000*2*1e-9*60 #L/h, Thin+thick (short +long) ascending
QDT_ref <- (6*26980 + 6*11020)*2*1e-9*60  #  Distal tubule (short + long)
QCD_ref <- 14.4* 6000*2*1e-9*60  #  collecting duct (Cortical + medullary)
# The values from Gilmer et al. (2018) are BW invariant. So since the GFR
# we use is scaled to BW and GFR = QPT, we scale these values based on the
# current GFR.
Q_scaling_factor = QGFR/QPT_ref
QPT <- Q_scaling_factor * QPT_ref #L/h, proximal tubule flow (short +long)
QTDL <- Q_scaling_factor * QTDL_ref #L/h, Thin descending limb (short +long)
QTAL <- Q_scaling_factor * QTAL_ref #L/h, Thin+thick (short +long) ascending
QDT <- Q_scaling_factor * QDT_ref  #L/h, Distal tubule (short + long)
QCD <- Q_scaling_factor * QCD_ref  #L/h, collecting duct (Cortical + medullary)
return(list(
'VKiB'=VKiB, 'VKiB_cap'=VKiB_cap, "VKiB_lv" = VKiB_lv,
'VKiF'=VKiF, 'VKT'=VKT, 'VFil'=VFil,'VBladder' = VBladder,
'VPT' = VPT, 'VDAL' = VDAL, 'VDT' = VDT, 'VCD' = VCD,
'VPTC' = VPTC, 'VDALC' = VDALC, 'VDTC' = VDTC, 'VCDC' = VCDC,
'VKTrest' = VKTrest,
'VLiB'=VLiB, 'VLiB_cap'=VLiB_cap,'VLiB_lv'=VLiB_lv, 'VLiF'=VLiF, 'VLiT'=VLiT, 'VBile'=VBile,
'VInB'=VInB, 'VInB_cap'=VInB_cap,'VInB_lv'=VInB_lv,'VInF'=VInF, 'VInT'=VInT,
'VSt_drained'=VSt_drained, 'VStB_cap'=VStB_cap, 'VStB_lv'=VStB_lv,'VStB'=VStB,'VStF'=VStF, 'VStT'=VStT,
'VStL'=VStL, 'VInL'=VInL,
'VMu_drained'=VMu_drained, 'VMuB'=VMuB, 'VMuB_cap'=VMuB_cap, 'VMuB_lv'=VMuB_lv, 'VMuF'=VMuF, 'VMuT'=VMuT,
'VAd_drained'=VAd_drained, 'VAdB'=VAdB,'VAdB_cap'=VAdB_cap,'VAdB_lv'=VAdB_lv, 'VAdF'=VAdF, 'VAdT'=VAdT,
'VLu_drained'=VLu_drained, 'VLuB'=VLuB,  'VLuB_cap'=VLuB_cap, 'VLuB_lv'=VLuB_lv,'VLuF'=VLuF,'VLuAF'=VLuAF, 'VLuT'=VLuT,
'VSp_drained'=VSp_drained, 'VSpB'=VSpB, 'VSpB_cap'=VSpB_cap,'VSpB_lv'=VSpB_lv,'VSpF'=VSpF, 'VSpT'=VSpT,
'VHt_drained'=VHt_drained, 'VHtB'=VHtB, 'VHtB_cap'=VHtB_cap,'VHtB_lv'=VHtB_lv,'VHtF'=VHtF, 'VHtT'=VHtT,
'VBr_drained'=VBr_drained, 'VBrB'=VBrB,'VBrB_cap'=VBrB_cap,'VBrB_lv'=VBrB_lv, 'VBrF'=VBrF, 'VBrT'=VBrT,
'VGo_drained'=VGo_drained, 'VGoB'=VGoB, 'VGoB_cap'=VGoB_cap,'VGoB_lv'=VGoB_lv,'VGoF'=VGoF, 'VGoT'=VGoT,
'VSk_drained'=VSk_drained,'VSkB'=VSkB, 'VSkB_cap'=VSkB_cap,'VSkB_lv'=VSkB_lv, 'VSkF'=VSkF, 'VSkT'=VSkT,
'VBo_drained'=VBo_drained,'VBoB'=VBoB, 'VBoB_cap'=VBoB_cap, 'VBoB_lv'=VBoB_lv, 'VBoF'=VBoF, 'VBoT'=VBoT,
'VRe_drained'=VRe_drained,'VReB'=VReB,'VReB_cap'=VReB_cap,'VReB_lv'=VReB_lv,'VReF'=VReF, 'VReT'=VReT,
"VKi_tot" = VKi_tot, "VLi_tot" = VLi_tot,  "VIn_tot" = VIn_tot, "VSt_tot" = VSt_tot, "VMu_tot" = VMu_tot,
"VAd_tot" = VAd_tot, "VLu_tot" = VLu_tot, "VSp_tot" = VSp_tot,
"VHt_tot" = VHt_tot, "VBr_tot" = VBr_tot, "VGo_tot" = VGo_tot, "VSk_tot" = VSk_tot, "VBo_tot" = VBo_tot, "VRe_tot" = VRe_tot,
"VBlood" = VBlood, 'VVen' = VVen, 'VArt' = VArt,
"MLi_drained" = MLi_drained,  "MKi_drained" = MKi_drained,  "MIn_drained" = MIn_drained, "MLu_drained" = MLu_drained,
"VLi_drained" = VLi_drained, "VKi_drained" = VKi_drained,
'A_peritubular' = A_peritubular,
'AL'=AL, 'AM'=AM, 'AA'=AA, 'AR'=AR, 'ALu'= ALu,
'ASP'=ASP, 'AH'=AH, 'ABr'=ABr, 'AST'= AST,
'AIN'=AIN, 'AGo'=AGo,
'ASK'= ASK, 'ABo'=ABo,
'AINL' = AINL, 'AcL' = AcL, 'AcM' = AcM, 'AcST' = AcST,
'AcIN' = AcIN, 'AcA' = AcA, 'AcLu' = AcLu, 'AcALF' = AcALF,
'AcSP' = AcSP, 'AcH' = AcH, 'AcBr' = AcBr, 'AcGo' = AcGo,
'AcSK' = AcSK, 'AcBo' = AcBo, 'AcR' = AcR, 'APT' = APT,
'ADAL' = ADAL, 'ADT' = ADT, 'ACD' = ACD, 'AcK_DTC' = AcK_DTC,
'AcK_PTC' = AcK_PTC, 'AcK_DALC' = AcK_DALC,
'AcK_CDC' = AcK_CDC, 'AcKTrest' = AcKTrest,
'Qcardiac'=Qcardiac, 'QBK'=QBK,
'QBL'=QBL, 'QBLtot'=QBLtot,
'QBM'=QBM, 'QBA'=QBA,
'QBR'=QBR, 'QBLu'=QBLu, 'Qfeces'=Qfeces,  'feces_density'=feces_density,
'Qbile'=Qbile, 'QGFR'=QGFR,'Qurine'=Qurine,
'QBSP'=QBSP, 'QBH'=QBH, 'QBBr'=QBBr, 'QBST'=QBST,
'QBIN'=QBIN, 'QGE'=QGE,
'QBGo'=QBGo,
'QBSK'=QBSK, 'QBBo'=QBBo,
"QPT" = QPT, "QTDL" = QTDL, "QTAL" = QTAL, "QDT" = QDT, "QCD" = QCD,
'f_tubular' =  f_tubular,  'f_PTC_prot_to_tub_prot' = f_PTC_prot_to_tub_prot,
'f_DALC_prot_to_tub_prot' = f_DALC_prot_to_tub_prot,
'f_DTC_prot_to_tub_prot' = f_DTC_prot_to_tub_prot ,
'f_CDC_prot_to_tub_prot' = f_CDC_prot_to_tub_prot,
"admin.time" = admin.time, "admin.dose" = admin.dose,
"admin.type" = admin.type, "MW"=MW, "sex" = sex, "BW" = BW
))
})
}
BW <- 0.3  # body weight (kg)
admin.dose_per_g <- 16.56 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_g*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in hours
admin.type <- "iv"
sex <- "M"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"admin.time" = admin.time,
"admin.type" = admin.type,
"sex" = sex)
pars <- create_fixed_params(user_input)
estimated_params <- rep(1,12)
variable_params <- create_variable_params(BW, sex,estimated_params, pars)
params <- c(pars, variable_params)
View(params)
params
View(params)
BW
# All volume values are in [L], densities are in kg/L
# The fraction of organ mass relative to body weight in Brown (1997) refers to drained organ mass.
# We assume that this means that the blood from large vessels was removed, but capillary blood in the organ still remains.
# We distinguish  blood into total residual blood, which is the blood remaining in both large vessels and capillaries
# in nonbled animals and capillary residual blood, which is the blood remaining in capillaries in bled animals. We take
# the residual blood fraction from Brown when possible (average of multiple studies in most cases).
# The capillary residual blood was drawn from Bernareggi and  Rowland (1991) [doi: 10.1007/BF01062191], which was measured after bleeding the animals.
# Thus, we assume that the reported values were calculated relative to bled tissue that contains residual blood only in the capillaries and not in the large vessels.
# We assume that the fraction of interstitial space from Kawai et al. (1994) is relative to the parenchyma organ volume.
# We base this on Tsuji et al. , which is one of the references used. In the latter reference, the
# ISF is calculated on a blood-free organ weight basis.
#Kidney
PVKi <- 7.3e-3 #fraction of drained kidney mass relative to body weight. from Brown et al. (1997)
d_kidney <- 1.05 #density of kidneys [kg/L]
VKi_drained <- PVKi * BW / d_kidney #volume of  drained kidneys
MKi_drained <- VKi_drained * d_kidney
fcap_ki <- 0.046 #blood remaining in rat organs after bleeding, in [ml/g drained tissue].from Bernareggi and  Rowland (1991)
VKiB_cap <- fcap_ki * MKi_drained  #volume of kidney blood in capillaries
PVKiB <- 0.16 #fraction of residual blood in kidneys. from Brown et al. (1997)
VKi_tot <- (VKi_drained-VKiB_cap)/(1-PVKiB) #total kidney volume
MK <- (VKi_drained - VKiB_cap) *d_kidney #total kidney parenchyma mass
VKiB <- PVKiB * VKi_tot #residual blood volume  in kidneys
fcap_to_blood_ki<-  VKiB_cap/VKiB #fraction of capillary to total organ blood
PVKF <- 0.13 # fraction of interstitial fluid in kidneys.From Larson et al. (1984) [doi: 10.1111/j.1748-1716.1984.tb00137.x]
VKiF <- PVKF *(VKi_drained - VKiB_cap) #kidney interstitial fluid volume
VKiB_lv <-  VKiB - VKiB_cap #volume of kidney blood in large vessels (lv)
# Here we assume that the length of each segment of the renal tubule is
# analogous to the body weight of the kidney in order to obtain
# volumes and surface areas as a linear function of BW
VKi_ref <- (2*2.9/ d_kidney)/1000 # [L]. Gilmer et al. (2018) handled data from Sperber, 1944 (Thesis: â€œStudies on the Mammalian Kidney").
# In Sperber, p.303, it says that the kidneys of an old female white rat were used. We assume that the
# weight provided refers to a single kidney and not both.
#Total Length of renal tubules, from Gilmer et al. (2018) [doi:10.1152/ajprenal.00219.2018]
LPT_slp <- (VKi_tot/VKi_ref)*(9886*1e-6)*26980*2 #[m], Proximal tubule (short-looped nephrons)
LPT_llp <- (VKi_tot/VKi_ref)*(11077*1e-6 )*11020*2#[m], Proximal tubule (long-looped nephrons)
LPT <- LPT_slp+LPT_llp
LTDL_slp <- (VKi_tot/VKi_ref)*(1500*1e-6)*26980*2 #[m], Thin descending limb (short-looped nephrons)
LTDL_llp <- (VKi_tot/VKi_ref)*(6200*1e-6)*11020*2 #[m], Thin descending limb (long-looped nephrons)
LThinAL <-(VKi_tot/VKi_ref)* (4700*1e-6)*11020*2 #[m], Thin ascending limb (long-looped nephrons)
LThickAL_cort <- (VKi_tot/VKi_ref)*(1450*1e-6)*38000*2 #[m], Cortical thick ascending limb
LThickAL_med <- (VKi_tot/VKi_ref)*(2100*1e-6)*38000*2 #[m], Medullary thick ascending limb
LDT_sup <- (VKi_tot/VKi_ref)*(1452*1e-6)*26980*2 #[m], Distal tubule* (superficial)
LDT_deep <- (VKi_tot/VKi_ref)*(1650*1e-6)*11020*2 #[m], Distal tubule* (deep)
LDT <- LDT_sup + LDT_deep
Lduct_cort <- (VKi_tot/VKi_ref)*(2900*1e-6)*6000*2 #[m], Cortical collecting duct
Lduct_med <-  (VKi_tot/VKi_ref)*(2100*1e-6)*6000*2 #[m], Outer medullary collecting duct
LPT
LTDL_slp+LTDL_llp
LThinAL
LThickAL_cort+LThickAL_med
LDT
Lduct_cort+Lduct_med
