#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd("/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_results_plots/Validation")
# Load Results
# Results from Cui
Cui_2010_Excreta_results <- read.csv("Cui_2010_Excreta_results.csv", header = T)
Cui_Urine_M_5 <- Cui_2010_Excreta_results[Cui_2010_Excreta_results$Dose == 5 &
Cui_2010_Excreta_results$Tissue  == "Urine" &
Cui_2010_Excreta_results$Sex == "M", ]
Cui_Urine_M_5$Experiment <- "Cui | 5mg/kg | Urine | M"
Cui_Urine_M_20 <- Cui_2010_Excreta_results[Cui_2010_Excreta_results$Dose == 20 &
Cui_2010_Excreta_results$Tissue  == "Urine" &
Cui_2010_Excreta_results$Sex == "M", ]
Cui_Urine_M_20$Experiment <- "Cui | 20mg/kg | Urine | M"
Cui_Feces_M_5 <- Cui_2010_Excreta_results[Cui_2010_Excreta_results$Dose == 5 &
Cui_2010_Excreta_results$Tissue  == "Feces" &
Cui_2010_Excreta_results$Sex == "M", ]
Cui_Feces_M_5$Experiment <- "Cui | 5mg/kg | Feces | M"
Cui_Feces_M_20 <- Cui_2010_Excreta_results[Cui_2010_Excreta_results$Dose == 20 &
Cui_2010_Excreta_results$Tissue  == "Feces" &
Cui_2010_Excreta_results$Sex == "M", ]
Cui_Feces_M_20$Experiment <- "Cui | 20mg/kg | Feces | M"
#Results from Lupton 2020
Lupton_2020_Excreta_results <- read.csv("Lupton_2020_excreta_results.csv", header = T, colClasses = c("sex" = "character"))
Lupton_Feces_F <- Lupton_2020_Excreta_results[Lupton_2020_Excreta_results$Dose == 0.047 &
Lupton_2020_Excreta_results$Tissue  == "Feces" &
Lupton_2020_Excreta_results$sex == "F", ]
Lupton_Feces_F$Experiment <- "Lupton | 0.047mg/kg | Feces | F"
Lupton_Urine_F <- Lupton_2020_Excreta_results[Lupton_2020_Excreta_results$Dose == 0.047 &
Lupton_2020_Excreta_results$Tissue  == "Urine" &
Lupton_2020_Excreta_results$sex == "F", ]
Lupton_Urine_F$Experiment <- "Lupton | 0.047mg/kg | Urine | F"
Experiment <- scales::hue_pal()(6)
names(Experiment) <- unique(c( Cui_Urine_M_5$Experiment, Cui_Urine_M_20$Experiment,
Cui_Feces_M_5$Experiment, Cui_Feces_M_20$Experiment,
Lupton_Feces_F$Experiment, Lupton_Urine_F$Experiment))
# Create legend data
legend_lines <- data.frame(
x = 1, y = 1,
type = factor(c("1x (identity)", "±2-fold", "±3-fold", "±10-fold"),
levels = c("1x (identity)", "±2-fold", "±3-fold", "±10-fold"))
)
scatter_plot <- ggplot() +
# Error range lines
geom_abline(intercept = log10(1), slope = 1, linetype = "solid", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
# Data points (original style)
geom_point(data = Cui_Urine_M_5, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Cui_Urine_M_20, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Cui_Feces_M_5, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Cui_Feces_M_20, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Lupton_Feces_F, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Lupton_Urine_F, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
# Axes
scale_x_log10() +
scale_y_log10() +
# Color and shape scales
scale_color_manual(values = Experiment) +
# Labels
labs(
x = expression("Observed Mass (mg PFOA)"),
y = expression("Predicted Mass (mg PFOA )"),
color = "Experiment",
shape = "Tissue"
) +
# Theme to match create.plots
theme_bw(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.position = "bottom",
legend.box = "vertical",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_blank(),
legend.spacing.y = unit(0.5, "cm")
)
# Save the final figure
ggsave("validation_plot_PFOA_excreta.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd("/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_results_plots/Validation")
# Load Results
#
Kemper_serum_results <- read.csv("Kemper_2003_serum_results.csv", header = T)
Kemper_iv_F_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "iv" &
Kemper_serum_results$sex == "F", ]
Kemper_iv_F_1$Experiment <- "Kemper | 1mg/kg | iv | F"
Kemper_oral_F_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_1$Experiment <- "Kemper | 1mg/kg | oral | F"
Kemper_oral_F_5 <- Kemper_serum_results[Kemper_serum_results$Dose == 5 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_5$Experiment <- "Kemper | 5mg/kg | oral | F"
Kemper_oral_F_25 <- Kemper_serum_results[Kemper_serum_results$Dose == 25 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_25$Experiment <- "Kemper | 25mg/kg | oral | F"
Kemper_iv_M_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "iv" &
Kemper_serum_results$sex == "M", ]
Kemper_iv_M_1$Experiment <- "Kemper | 1mg/kg | iv | M"
Kemper_oral_M_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_1$Experiment <- "Kemper | 1mg/kg | oral | M"
Kemper_oral_M_5 <- Kemper_serum_results[Kemper_serum_results$Dose == 5 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_5$Experiment <- "Kemper | 5mg/kg | oral | M"
Kemper_oral_M_25 <- Kemper_serum_results[Kemper_serum_results$Dose == 25 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_25$Experiment <- "Kemper | 25mg/kg | oral | M"
#
# Kudo_high <- Kudo_results[Kudo_results$Dose == 16.560, ]
# Kudo_high$Experiment <-  "Kudo | 16mg/kg | iv"
#
# Kim_results <- read.csv("Kim_results.csv", header = T)
# Kim_iv <- Kim_results[Kim_results$Type == "iv",]
# Kim_iv$Experiment <-  "Kim | 1mg/kg | iv"
#
# Kim_oral <- Kim_results[Kim_results$Type == "oral",]
# Kim_oral$Experiment <-  "Kim | 1mg/kg | oral"
Experiment <- scales::hue_pal()(8)
names(Experiment) <- unique(c( Kemper_iv_F_1$Experiment, Kemper_iv_M_1$Experiment,
Kemper_oral_F_1$Experiment,Kemper_oral_M_1$Experiment, Kemper_oral_F_5$Experiment,
Kemper_oral_M_5$Experiment,  Kemper_oral_F_25$Experiment, Kemper_oral_M_25$Experiment))
scatter_plot <- ggplot()+
# Error range lines
geom_abline(intercept = log10(1), slope = 1, linetype = "solid", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_point(data = Kemper_iv_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_5, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_iv_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_5, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
# Axes
scale_x_log10() +
scale_y_log10() +
# Color and shape scales
scale_color_manual(values = Experiment) +
# Labels
labs(
x = expression("Observed Concentration (mg PFOA / L serum)"),
y = expression("Predicted Concentration (mg PFOA / L serum)"),
color = "Experiment",
shape = "Tissue"
) +
# Theme to match create.plots
theme_bw(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.position = "bottom",
legend.box = "vertical",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_blank(),
legend.spacing.y = unit(0.5, "cm")
)
#print(scatter_plot)
ggsave("validation_plot_PFOA_serum.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd('/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_Inhalation_model/Validation/Validation_results')
# Load Results
#
Hinderliter_2006_results <- read.csv("Hinderliter_2006_results.csv", header = T)
Hinderliter_nasal_M_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | M"
Hinderliter_nasal_F_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | F"
Hinderliter_nasal_M_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | M"
Hinderliter_nasal_F_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | F"
Hinderliter_nasal_M_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | M"
Hinderliter_nasal_F_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | F"
Experiment <- scales::hue_pal()(6)
names(Experiment) <- unique(c( Hinderliter_nasal_M_1$Experiment, Hinderliter_nasal_F_1$Experiment,
Hinderliter_nasal_M_10$Experiment,Hinderliter_nasal_F_10$Experiment,
Hinderliter_nasal_M_25$Experiment, Hinderliter_nasal_F_25$Experiment))
ggplot(data = Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$sex == "F",])+
geom_line(aes(x =Time, y= Predicted ))+
geom_point(aes(x =Time, y= Observed ))
scatter_plot <- ggplot()+
geom_abline(intercept = log10(1), slope = 1, linetype = "dashed", color = "black", linewidth = 1.5, alpha = 0.7) +  # Identity line in log10 scale
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # +3-fold error line
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # -3-fold error line
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # +10-fold error line
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # -10-fold error line
geom_point(data = Hinderliter_nasal_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
scale_y_log10()+
scale_x_log10()+
scale_color_manual(values = Experiment)+
theme(legend.spacing.y = unit(1, 'cm')) +
guides(fill = guide_legend(byrow = TRUE))+
theme_light()+
labs(y = "Predicted PFOA (mg/L tissue)",
x = "Observed PFOA ( mg/L tissue)")+
theme(plot.title = element_text(hjust = 0.5),
legend.key.size = unit(0.75, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12,  hjust = 0),
axis.text = element_text(size = 14),
axis.title = element_text(size = 14),
)
#print(scatter_plot)
ggsave("validation_plot_PFOA_serum.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
library(dplyr)
# Set working directory
setwd("/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_results_plots/Validation")
# Load Results
Cui_results <- read.csv("Cui_2008_results.csv", header = TRUE)
lupton_results <- read.csv("Lupton_2020_tissue_results.csv", header = TRUE)
# Filter by dose and add experiment label
Cui_low <- Cui_results %>%
filter(Dose == 5, !is.na(Observed), !is.na(Predicted), Observed > 0, Predicted > 0) %>%
mutate(Experiment = "Cui | 5mg/kg | oral | M")
Cui_high <- Cui_results %>%
filter(Dose == 20, !is.na(Observed), !is.na(Predicted), Observed > 0, Predicted > 0) %>%
mutate(Experiment = "Cui | 20mg/kg | oral | M")
lupton <- lupton_results %>%
filter( !is.na(Predicted), Observed > 0, Predicted > 0) %>%
mutate(Experiment = "Lupton | 0.047mg/kg | oral | F")
# Tissue marker names (optional if used elsewhere)
Tissue_markers <- c(0:10, 15, 16)
names(Tissue_markers) <- c("Lung", "Spleen", "Liver", "Kidney", "Plasma", "Heart",
"Brain", "Testis", "Stomach", "Intestines", "Carcass", "Skin")
# Define color palette for experiments
Experiment <- scales::hue_pal()(3)
names(Experiment) <- unique(c(Cui_low$Experiment, Cui_high$Experiment, lupton$Experiment ))
# Manually assign shapes for up to 8 tissues
shape_values <- c(0:6, 15, 16)
# Build scatter plot
scatter_plot <- ggplot() +
# Error range lines
geom_abline(intercept = log10(1), slope = 1, linetype = "solid", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
# Data points
geom_point(data = Cui_low, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = Cui_high, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
geom_point(data = lupton, aes(x = Observed, y = Predicted, color = Experiment, shape = Tissue), size = 4, stroke = 1.5) +
# Log-scale axes
scale_x_log10() +
scale_y_log10() +
# Manual color and shape scales
scale_color_manual(values = Experiment) +
scale_shape_manual(values = shape_values) +
# Axis labels
labs(
x = expression("Observed Concentration (mg PFOA / L tissue)"),
y = expression("Predicted Concentration (mg PFOA / L tissue)"),
color = "Experiment",
shape = "Tissue"
) +
# Unified theme
theme_bw(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.position = "bottom",
legend.box = "vertical",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_blank(),
legend.spacing.y = unit(0.5, "cm")
)
# Save figure
ggsave("validation_plot_PFOA_tissues.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd('/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_Inhalation_model/Validation/Validation_results')
# Load Results
#
Hinderliter_2006_results <- read.csv("Hinderliter_2006_results.csv", header = T)
Hinderliter_nasal_M_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | M"
Hinderliter_nasal_F_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | F"
Hinderliter_nasal_M_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | M"
Hinderliter_nasal_F_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | F"
Hinderliter_nasal_M_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | M"
Hinderliter_nasal_F_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | F"
Experiment <- scales::hue_pal()(6)
names(Experiment) <- unique(c( Hinderliter_nasal_M_1$Experiment, Hinderliter_nasal_F_1$Experiment,
Hinderliter_nasal_M_10$Experiment,Hinderliter_nasal_F_10$Experiment,
Hinderliter_nasal_M_25$Experiment, Hinderliter_nasal_F_25$Experiment))
ggplot(data = Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$sex == "F",])+
geom_line(aes(x =Time, y= Predicted ))+
geom_point(aes(x =Time, y= Observed ))
scatter_plot <- ggplot()+
geom_abline(intercept = log10(1), slope = 1, linetype = "dashed", color = "black", linewidth = 1.5, alpha = 0.7) +  # Identity line in log10 scale
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # +3-fold error line
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # -3-fold error line
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # +10-fold error line
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # -10-fold error line
geom_point(data = Hinderliter_nasal_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
scale_y_log10()+
scale_x_log10()+
scale_color_manual(values = Experiment)+
theme(legend.spacing.y = unit(1, 'cm')) +
guides(fill = guide_legend(byrow = TRUE))+
theme_light()+
labs(y = "Predicted PFOA (mg/L tissue)",
x = "Observed PFOA ( mg/L tissue)")+
theme(plot.title = element_text(hjust = 0.5),
legend.key.size = unit(0.75, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12,  hjust = 0),
axis.text = element_text(size = 14),
axis.title = element_text(size = 14),
)
#print(scatter_plot)
ggsave("validation_plot_PFOA_nasal_serum.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd("/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_results_plots/Validation")
# Load Results
#
Kemper_serum_results <- read.csv("Kemper_2003_serum_results.csv", header = T)
Kemper_iv_F_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "iv" &
Kemper_serum_results$sex == "F", ]
Kemper_iv_F_1$Experiment <- "Kemper | 1mg/kg | iv | F"
Kemper_oral_F_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_1$Experiment <- "Kemper | 1mg/kg | oral | F"
Kemper_oral_F_5 <- Kemper_serum_results[Kemper_serum_results$Dose == 5 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_5$Experiment <- "Kemper | 5mg/kg | oral | F"
Kemper_oral_F_25 <- Kemper_serum_results[Kemper_serum_results$Dose == 25 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "F", ]
Kemper_oral_F_25$Experiment <- "Kemper | 25mg/kg | oral | F"
Kemper_iv_M_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "iv" &
Kemper_serum_results$sex == "M", ]
Kemper_iv_M_1$Experiment <- "Kemper | 1mg/kg | iv | M"
Kemper_oral_M_1 <- Kemper_serum_results[Kemper_serum_results$Dose == 1 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_1$Experiment <- "Kemper | 1mg/kg | oral | M"
Kemper_oral_M_5 <- Kemper_serum_results[Kemper_serum_results$Dose == 5 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_5$Experiment <- "Kemper | 5mg/kg | oral | M"
Kemper_oral_M_25 <- Kemper_serum_results[Kemper_serum_results$Dose == 25 & Kemper_serum_results$Type == "oral" &
Kemper_serum_results$sex == "M", ]
Kemper_oral_M_25$Experiment <- "Kemper | 25mg/kg | oral | M"
#
# Kudo_high <- Kudo_results[Kudo_results$Dose == 16.560, ]
# Kudo_high$Experiment <-  "Kudo | 16mg/kg | iv"
#
# Kim_results <- read.csv("Kim_results.csv", header = T)
# Kim_iv <- Kim_results[Kim_results$Type == "iv",]
# Kim_iv$Experiment <-  "Kim | 1mg/kg | iv"
#
# Kim_oral <- Kim_results[Kim_results$Type == "oral",]
# Kim_oral$Experiment <-  "Kim | 1mg/kg | oral"
Experiment <- scales::hue_pal()(8)
names(Experiment) <- unique(c( Kemper_iv_F_1$Experiment, Kemper_iv_M_1$Experiment,
Kemper_oral_F_1$Experiment,Kemper_oral_M_1$Experiment, Kemper_oral_F_5$Experiment,
Kemper_oral_M_5$Experiment,  Kemper_oral_F_25$Experiment, Kemper_oral_M_25$Experiment))
scatter_plot <- ggplot()+
# Error range lines
geom_abline(intercept = log10(1), slope = 1, linetype = "solid", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/2), slope = 1, linetype = "dashed", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "black", linewidth = 1.2) +
geom_point(data = Kemper_iv_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_5, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_F_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_iv_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_5, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Kemper_oral_M_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
# Axes
scale_x_log10() +
scale_y_log10() +
# Color and shape scales
scale_color_manual(values = Experiment) +
# Labels
labs(
x = expression("Observed Concentration (mg PFOA / L serum)"),
y = expression("Predicted Concentration (mg PFOA / L serum)"),
color = "Experiment",
shape = "Tissue"
) +
# Theme to match create.plots
theme_bw(base_size = 14) +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
legend.position = "bottom",
legend.box = "vertical",
legend.title = element_text(size = 14),
legend.text = element_text(size = 13),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_blank(),
legend.spacing.y = unit(0.5, "cm")
)
#print(scatter_plot)
ggsave("validation_plot_PFOA_serum.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
library(ggplot2)
#setwd("C:/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Validation/Validation_results")
setwd("/Users/user/Documents/GitHub/PFAS_PBK_models/PFOA inhalation Rat/Scenarios/Final_results_plots/Validation")
# Load Results
#
Hinderliter_2006_results <- read.csv("Hinderliter_2006_results.csv", header = T)
Hinderliter_nasal_M_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | M"
Hinderliter_nasal_F_1 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 1 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_1$Experiment <- "Hinderliter | 1mg/m3 | nasal | F"
Hinderliter_nasal_M_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | M"
Hinderliter_nasal_F_10 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_10$Experiment <- "Hinderliter | 10mg/m3 | nasal | F"
Hinderliter_nasal_M_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "M", ]
Hinderliter_nasal_M_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | M"
Hinderliter_nasal_F_25 <- Hinderliter_2006_results[Hinderliter_2006_results$Dose == 25 & Hinderliter_2006_results$Type == "nasal" &
Hinderliter_2006_results$sex == "F", ]
Hinderliter_nasal_F_25$Experiment <- "Hinderliter | 25mg/m3 | nasal | F"
Experiment <- scales::hue_pal()(6)
names(Experiment) <- unique(c( Hinderliter_nasal_M_1$Experiment, Hinderliter_nasal_F_1$Experiment,
Hinderliter_nasal_M_10$Experiment,Hinderliter_nasal_F_10$Experiment,
Hinderliter_nasal_M_25$Experiment, Hinderliter_nasal_F_25$Experiment))
ggplot(data = Hinderliter_2006_results[Hinderliter_2006_results$Dose == 10 & Hinderliter_2006_results$sex == "F",])+
geom_line(aes(x =Time, y= Predicted ))+
geom_point(aes(x =Time, y= Observed ))
scatter_plot <- ggplot()+
geom_abline(intercept = log10(1), slope = 1, linetype = "dashed", color = "black", linewidth = 1.5, alpha = 0.7) +  # Identity line in log10 scale
geom_abline(intercept = log10(3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # +3-fold error line
geom_abline(intercept = log10(1/3), slope = 1, linetype = "dotted", color = "red", linewidth = 1.5, alpha = 0.7) +  # -3-fold error line
geom_abline(intercept = log10(10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # +10-fold error line
geom_abline(intercept = log10(1/10), slope = 1, linetype = "dotdash", color = "blue", linewidth = 1.5, alpha = 0.7) +  # -10-fold error line
geom_point(data = Hinderliter_nasal_M_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_1, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_10, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_M_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
geom_point(data = Hinderliter_nasal_F_25, aes(x=Observed, y=Predicted, color = Experiment, shape = Tissue), size=4, stroke = 1.5)+
scale_y_log10()+
scale_x_log10()+
scale_color_manual(values = Experiment)+
theme(legend.spacing.y = unit(1, 'cm')) +
guides(fill = guide_legend(byrow = TRUE))+
theme_light()+
labs(y = "Predicted PFOA (mg/L tissue)",
x = "Observed PFOA ( mg/L tissue)")+
theme(plot.title = element_text(hjust = 0.5),
legend.key.size = unit(0.75, 'cm'),
legend.title = element_text(size=14),
legend.text = element_text(size=12,  hjust = 0),
axis.text = element_text(size = 14),
axis.title = element_text(size = 14),
)
#print(scatter_plot)
ggsave("validation_plot_PFOA_nasal_serum.png", scatter_plot, width = 11, height = 7, units = "in", dpi = 300)
