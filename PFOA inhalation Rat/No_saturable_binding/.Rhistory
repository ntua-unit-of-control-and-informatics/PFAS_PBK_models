VMuF <- PVMF * PVMu * BW #muscle interstitial fluid volume kg=L
VMuT <- VMu - VMuF #muscle tissue volume kg=L
#Adipose
PVAd <- 7e-2 #Brown et al. 1997
VAd <- PVAd * BW #adipose volume kg=L
PVAB <- 0.02 #Brown et al. 1997
VAdB <- PVAB * PVAd * BW #% adipose blood volume kg=L
PVAF <- 0.174 #Ng, 2013
VAdF <- PVAF * PVAd * BW #adipose interstitial fluid volume kg=L
VAdT <- VAd - VAdF #adipose tissue volume kg=L
#Lymph nodes
PVLy <- 1.15/280 #Shah & Betts, 2012. https://doi.org/10.1007/s10928-011-9232-2
VLy <- PVLy*BW#lymph fluid volume
#Lung
PVLu <- 0.48e-2 #Brown et al. 1997, p 418-19 mean of values for male rat
VLu <- PVLu * BW
PVLuB <- 0.09*VLu #Brown et al. 1997, p 459 --> capillary blood occupied 9% of the lung volume
VLuB <- PVLuB * PVLu * BW #volume of the blood of lung kg=L
PVLuF <- 0.263/280 #0.263 ml, Shah & Betts, 2012. https://doi.org/10.1007/s10928-011-9232-2
VLuF <- PVLuF * PVLu * BW #lung interstitial fluid volume
PVLuAF <- 0.4/275 #0.4 mL Leslie et al, 1989 https://doi.org/10.1164/ajrccm/139.2.360 --> Watkins & Rannels 1979 https://doi.org/10.1152/jappl.1979.47.2.325
VLuAF <- PVLuAF * PVLu * BW #lung alveolar lining fluid volume kg=LL
PVLuT <- VLu - VLuF - VLuAF
VLuT <- PVLuT * PVLu* BW #lung tissue volume kg=L
#Spleen
PVSp <- 0.2e-2  #Brown et al. 1997, p 416, Table 5
VSp <- PVSp * BW
PVSPB <- 0.22 #Brown et al. 1997, p 458, Table 30
VSpB <- PVSPB * PVSp * BW #volume of the blood of spleen kg=L
PVSPF <- 0.554/280 #ml/g -> Shah & Betts, 2012. https://doi.org/10.1007/s10928-011-9232-2
VSpF <- PVSPF * PVSp * BW #spleen interstitial fluid volume kg=L
VSpT <- VSp - VSpF #spleen tissue volume kg=L
#Heart
PVHt <- 0.33e-2  #Brown et al. 1997, p 416, Table 5
VHt <- PVHt * BW
PVHB <- 0.26 #Brown et al. 1997, p 458, Table 30
VHtB <- PVHB * PVHt * BW #volume of the blood of heart kg=L
PVHF <- PVHt * 0.22 #https://doi.org/10.1016/S0022-2828(87)80559-X --> IS 22% of dry tissue
VHtF <- PVHF * PVHt * BW #heart interstitial fluid volume kg=L
VHtT <- VHt - VHtF #heart tissue volume kg=L
#Brain
PVBr <- 0.57e-2  #Brown et al. 1997, p 416, Table 5
VBr <- PVBr * BW
PVBrB <- 0.03 #Brown et al. 1997, p 458, Table 30
VBrB <- PVBrB * PVBr * BW #volume of the blood of brain kg=L
PVBrF <- 17.5 * VBrB #https://doi.org/10.1016/j.pneurobio.2015.12.007 --> The ISS occupies 15% to 20% of the total brain volume
VBrF <- PVBrF * PVBr * BW #brain interstitial fluid volume kg=L
VBrT <- VBr - VBrF #brain tissue volume kg=L
#Gonads
PVGo <- 1.24/239.03 #Table 01 https://doi.org/10.1590/S1516-89132012000100013
VGo <- PVGo * BW
PVGoB <- 4.75e-2/1.49/243 #Figure 2 https://doi.org/10.1007/BF00410278 --> blood weight/g of gonads/BW
VGoB <-PVGoB * PVGo * BW #volume of the blood of gonads kg=L
PVGoF <- 0.16/239.03 #Table 02 https://doi.org/10.1590/S1516-89132012000100013
VGoF <- PVGoF * PVGo * BW #gonads interstitial fluid volume kg=L
VGoT <- VGo - VGoF #gonads tissue volume kg=L
#Skin
PVSk <- 19.03/100 #Brown et al. 1997, p 416, Table 5
VSk <- PVSk * BW
PVSkB <- 0.02 #Brown et al. 1997, p 458, Table 3
VSkB <-PVSkB * PVSk * BW #volume of the blood of gonads kg=L
PVSkF <- 40*VSk/100/0.225 # https://doi.org/10.1111/j.1748-1716.1981.tb06901.x 40 mL/100 g tissue, BW = 200-250 g
VSkF <- PVSkF * PVSk * BW #gonads interstitial fluid volume kg=L
VSkT <- VSk - VSkF #gonads tissue volume kg=L
#RoB
PVRe <- 1 - PVB - PVKi - PVLi - PVSt - PVIn - PVMu - PVAd - PVLu - PVSp - PVHt - PVBr - PVGo  - PVSk
VRe <- PVRe * BW #volume of the rest of the body kg=LL
PVReB <- 0.036
VReB <- PVReB * PVRe * BW #volume of the blood of the rest of body kg=L
PVReF <- 0.18
VReF <- PVReF * PVRe * BW #interstitial fluid volume of the rest of body kg=L
VReT <- VRe - VReF #tissue volume of the rest of body kg=L
######################################
#----------------------------------- #
#           Surface Areas            #
#----------------------------------- #
######################################
#Capillary surface area for each tissue (Ai) as percentage of body weight
#or weight of corresponding tissue (PAi, m^2/g) and surface area (m^2)
PAK <- 350e-4 #[cm2/g]*1e-4--> m^2/g  https://doi.org/10.1111/j.1748-1716.1963.tb02652.x
AK <- PAK * VK * 1e3 #kidney surface area (m^2)
PAKG <- 68.90e-4
AKG <- PAKG * VK * 1e3 #the surface area of glomerular capillary (m^2)
PAL <- 250e-4
AL <- PAL * VLi * 1e3 #liver surface area (m^2)
PAST <- 100e-4 #Cheng et al., 2017 value for gut
AST <- PAST * VSt * 1e3 #stomach surface area (m^2)
PAStL<- 100e-4 #Cheng et al., 2017 value for gut
AStL<- PAStL * VStL #stomach lumen surface area (m^2)
PAIN <- 100e-4 #Cheng et al., 2017 value for gut
AIN <- PAIN * VIn * 1e3 #intestine surface area (m^2)
#Calculations of rat intestinal lumen surface area based on Kothari et al. (2020),https://doi.org/10.1002/btm2.10146
# Lengths
L_duodenum <- 9.6# cm
L_jejunum <- 26 #cm
L_ileum <- 34.4# cm
# Inner diameters
d_duodenum <- 2.21 #cm
d_jejunum <- 2.56 #cm
d_ileum <- 3.36 #cm
SA_ref <- 2*pi*(d_duodenum/2)*L_duodenum + 2*pi*(d_jejunum/2)*L_jejunum + 2*pi*(d_ileum/2)*L_ileum #cm^2
#Allometric scaling
SA <- SA_ref* (BW/0.19)^(2/3) # O.19 kg is the BW of rats used in Kothari et al. (2020)
n <- 5 #enlargement factor of apical membrane of proximal tubule or enterocytes
AInL <- n * SA * 1e-4 #m^2
PAM <- 70*1e-4 #m2/g tissue
AM <- PAM * VMu *1e03 #muscle surface area (m^2)
PAA <- 70e-4 #m2/g tissue
AA <- PAA * VAd *1e03#adipose surface area (m^2)
PAR <- 100e-4#m2/g tissue
AR <- PAR * VRe *1e03#surface area of rest of body (m^2)
PLu <- 250e-4  #m2/g tissue      #https://doi.org/10.1111/j.1748-1716.1963.tb02652.x
ALu <- PLu* VLu*1e03 #lung surface area (m^2)
PSP <- 70e-4 #m2/g tissue
ASP <- PSP* VSp *1e03 #spleen surface area (m^2), same as muscle #assumption
#PH <- 50.3e-3/302 #50313 mm^2/kg --> *e-6 --> m^2/kg  https://doi.org/10.1007/BF00410278
PH <-  67.8# mm^2/mm^3 <--> m2/L of tissue, from group III in https://doi.org/10.1016/S0022-2828(87)80533-3
AH <- PH* VHt #heart surface area (m^2)
PBr <- 240e-4#m2/g tissue     #https://doi.org/10.1111/j.1748-1716.1963.tb02652.x
ABr <- PBr* VBr *1e03 #brain surface area (m^2)
PT <- 70e-4#m2/g tissue
AGo <- PT* VGo *1e03 #gonads surface area (m^2), same as muscle #assumption
PSK <- 70e-4#m2/g tissue
#ASK <- PSK* VSk * 1e7 #skin surface area (m^2), same as muscle #assumption
ASK <- PSK* VSk*1e03 #skin surface area (m^2), same as muscle #assumption
######################################
#----------------------------------- #
#           Blood Flows              #
#----------------------------------- #
######################################
#Blood flow rates (QBi, in L/h) to different tissues (i=L, K, G, A, M, R)
#as a percentage of cardiac output (Qcardiac L/h), which itself is a function
#of body weight (BW)
Qcardiac <- 0.235 * (BW^0.75) *60 #L/min->*60-> L/h
PQBKi <- 14.1/100 #Brown et al. 1997, p 438, Table 23
QBKi <- PQBKi * Qcardiac #L/h
PQBLi <- 2.1/100
QBLi <- PQBLi * Qcardiac #L/h Brown et al. 1997, p 438, Table 23
PQBSt <- 0.16/100 #https://doi.org/10.3390/pharmaceutics6010097 Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBSt = (8/1000)/Qcard *100
QBSt <- PQBSt * Qcardiac #L/h
PQBIn <- 9/100 #https://doi.org/10.3390/pharmaceutics6010097 Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBIn = (451/1000)/Qcard *100
QBIn <- PQBIn * Qcardiac #L/h
PQBMu <- 27.8/100 #Brown et al. 1997, p 438, Table 23
QBMu <- PQBMu * Qcardiac #L/h
PQBAd <- 7/100 #Brown et al. 1997, p 438, Table 23
QBAd <- PQBAd * Qcardiac #L/h
PQBLu <- 1
QBLu <- PQBLu * Qcardiac #L/h
PQBSp <- 0.75/100 #https://doi.org/10.3390/pharmaceutics6010097 Qcard=0.235*(0.250^0.75)*60 (L/h) and PQBSp = (37.5/1000)/Qcard *100
QBSp <- PQBSp * Qcardiac #L/h
PQBHt <- 5.1/100 #Brown et al. 1997, p 438, Table 23
QBHt <- PQBHt * Qcardiac #L/h
PQBBr <- 2.0/100 #Brown et al. 1997, p 438, Table 23
QBBr <- PQBBr * Qcardiac #L/h
PQBGo <- 0.28/100 #https://doi.org/10.1152/ajpregu.1987.253.2.R228 Qcard=0.235*(0.335^0.75)*60 (L/h) and PQBGo = (0.295*60/1000)/Qcard *100
QBGo <- PQBGo * Qcardiac #L/h
PQBSk <- 1.35/100 #https://doi.org/10.1111/1523-1747.ep12277181 Qcard=0.235*(0.2^0.75)*60 (L/h) and PQBSk = (0.95*60/1000)/Qcard *100
QBSk <- PQBSk * Qcardiac #L/h
PQBRe = 1 - PQBKi- PQBLi - PQBSt - PQBIn  - PQBMu - PQBAd  - PQBHt - PQBSk - PQBSp - PQBGo - PQBBr
QBRe <- PQBRe * Qcardiac #L/h
# The total blood outflow from liver is the sum of the hepatic artery flow, flow from spleen, stomach and intestine
QBLitot <- QBLi + (QBSp-QBSp/500) + (QBIn-QBIn/500) + (QBSt-QBSt/500)
######################################
#----------------------------------- #
#          Other Fluid Rates         #
#----------------------------------- #
######################################
#Flow rate of fluids including feces, bile, urine and glomerular filtration rate (GFR), in L/h
QGE<- 0.54/BW^0.25 #gastric emptying time (1/(h*BW^0.25)); from Yang, 2013
#Qfeces <- 5.63/1000/24 #mL water/d --> L/h
PQbile <- 90/1000/24 # [mL/d/kg BW]/1000/24 --> L/h/kg BW
Qbile <- PQbile * BW #L/h
#PQurine <- 200/1000/24 #mL/d/kg BW --> L/h/kg
#Qurine <- PQurine * BW #L/h
Qfeces <- (8.18/0.21)*BW #g/kg BW, based on Cui et al.(2010)
feces_density <- 1.29 #g/cm^3 --> g/mL from Lupton 1986, Fig 1. Fiber free control diet, https://doi.org/10.1093/jn/116.1.164
if (sex == "M"){
PQGFR <- 62.1  #L/h/kg   Corley et al., 2005 https://doi.org/10.1093/toxsci/kfi119, GFRC --> scaled fraction of kidney weight
QGFR <- PQGFR * VK #L/h
Qurine <- (60/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, 10.1002/nau.1006
}else if(sex == "F"){
PQGFR <- 41.04  #L/h/kg  Corley et al., 2005 https://doi.org/10.1093/toxsci/kfi119, GFRC --> scaled fraction of kidney weight
QGFR <- PQGFR * VK #L/h
Qurine <- (85/1000)*BW/24 #([ml/d/kg]/1000)*BW/24 --> L/h, from Schmidt et al., 2001, 10.1002/nau.1006
}
################
#--------------#
#   Proteins   #
#--------------#
################
#Albumin concentration in blood and interstitial fluid compartments(mol/m^3 = 1e-6* nmol/g)
CalbB_init <- 486*1e-6 # #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbKiF_init <- 243*1e-6 # #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbLiF_init <- 243*1e-6 # #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbGutF <- 146*1e-6 #[umol/L]*1e-6 -->(mol/m3), from Cheng et al. (2017)
CalbStF_init <- 146*1e-6 # [umol/L]*1e-6 -->(mol/L), same as Gut (assumption)
CalbInF_init <- 146*1e-6 #[umol/L]*1e-6 -->(mol/L), same as Gut (assumption)
CalbMuF_init <- 146*1e-6 #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbAdF_init <- 73*1e-6 #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbReF_init <- 73*1e-6 #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CalbLy_init <- CalbGutF #assumption based on https://doi.org/10.1016/j.jconrel.2020.07.046
CalbLuF_init <- CalbGutF #assumption
CalbLuAF_init <- 10/100 * CalbB_init #based on Woods et al. 2015 statement https://doi.org/10.1016/j.jconrel.2015.05.269
MW_albumin <- 66500#g/mol
CalbSpF_init <- 243e-6 #[umol/L]*1e-6 -->(mol/L), same as liver (assumption)
CalbGoF_init <- 41/MW_albumin #mg/mL-->  (mol/L) from https://doi.org/10.1210/endo-116-5-1983 --> 41 mg/mL, MW=65 kg/mol
CalbHtF_init <- 65/MW_albumin##mg/mL--> (mol/L) https://doi.org/10.1007/s12291-010-0042-x --> 6.5 g/100 g tissue, MW=65 kg/mol
CalbBrF_init <- 8e-2/MW_albumin  ##mg/mL--> (mol/L) https://doi.org/10.1016/0014-4886(90)90158-O --> 0.08 g/L, MW=65 kg/mol
CalbSkF_init <- 21/MW_albumin ##mg/mL-->  (mol/L) https://doi.org/10.1111/j.1748-1716.1973.tb05464.x -->Table 2: 2.1 g/100 mL
#Alpha2mu-globulin concentration in kidney tissue (mol/L)
if (sex == "M"){
Ca2uKT <- 110e-6 #mol/L
}else if(sex == "F"){
Ca2uKT <- 0 #mol/L
}
#FABP concentration in kidney and liver tissue (mol/m^3)
CfabpKT <- 2.65*1e-6  #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
CfabpLT <- 133*1e-6  #[umol/L]*1e-6 -->(mol/L), from Cheng et al. (2017)
#Equilibrium association constant (L/mol= M-1) for albumin(Ka), FABP(KL_fabp),
#and alpha2u-globulin(Ka2u)
Ka <-  1e05 #[L/mol]
Ka2u <- 5*1e02 #[L/mol], value from Cheng et al. (2017)
Kfabp <- (1.2e5+4e4+1.9e4)  #[L/mol], value from Cheng et al. (2017)
kon_alb <- Ka * koff_alb #1/M/s
kon_a2u <- Ka2u * koff_a2u#1/M/s
kon_fabp <- Kfabp * koff_fabp #1/M/s
##########################################################
#--------------------------------------------------------#
#   Passive diffusion and active secretion/uptake rates  #
#--------------------------------------------------------#
##########################################################
#Effective permeability (Peff, in m/h) for blood (B), liver(L), kidney(K),
#stomach(ST),intestine (IN), adipose(A), muscle(M), spleen (SP), heart (H),
#brain (Br), gonads (T), rest of body(R)
#PeffB <- 4.98e-8*3600*CF_Peff1
PeffK <-5e-8*3600*CF_Peff
PeffL <- 5e-8*3600*CF_Peff
PeffST <- 5e-8*3600*CF_Peff #assumption
PeffIN <- 5e-8*3600*CF_Peff#assumption
PeffA <-5e-8*3600*CF_Peff
PeffM <- 5e-8*3600*CF_Peff
PeffR <- 5e-8*3600*CF_Peff
PeffLu <- 5e-8*3600*CF_Peff #assumption
PeffSP <- 5e-8*3600*CF_Peff #assumption
PeffH <- 5e-8*3600*CF_Peff #assumption
PeffBr <- 5e-8*3600*CF_Peff #assumption
PeffGo <- 5e-8*3600*CF_Peff #assumption
PeffSK <- 5e-8*3600*CF_Peff #assumption
#Overall mass transfer coefficients between subcompartments and passive
#diffusion rate constants. See SI section S3-1 for details
#passive diffusion rates
ClLFT_unscaled= 67.8 #uL/min/10^6 cells, Han et al. 2008
ClKFT_unscaled= 17.5 #uL/min/mg protein, Yang et al. 2010
ClGFT_unscaled= 18.1 #uL/min/mg protein, Kimura et al. 2017
ClStFT_unscaled= 18.1 #uL/min/mg protein, Kimura et al. 2017
ClINFT_unscaled= 18.1 #uL/min/mg protein, Kimura et al. 2017
ClMFT_unscaled= 18.1 #same as ClGFT
ClAFT_unscaled= 18.1 #same as ClGFT
ClRFT_unscaled= 18.1 #same as ClGFT
ClLuFT_unscaled= 18.1 #same as ClGFT
ClSPFT_unscaled= 18.1 #same as ClGFT
ClHFT_unscaled= 18.1 #same as ClGFT
ClBrFT_unscaled= 18.1 #same as ClGFT
ClTFT_unscaled= 18.1 #same as ClGFT
ClSKFT_unscaled= 18.1 #same as ClGFT
#For all CMuTs
MW = 414.07 #g/mol, PFOA molecular weight
Acell = 4000 #um^2/cell
#Kidney
kidney_protein_per_rat <- 1000*(0.218+0.225+0.212)/3#mg of protein per rat  (Addis 1936)
rat_weight_addis <- 200 #g, average rat weight in Addis, 1936
rat_kidney_weight_addis <- rat_weight_addis*0.0073 # kidney fraction to BW, Brown (1997)
kidney_protein_per_gram <- kidney_protein_per_rat/rat_kidney_weight_addis #mg of protein/g kidney
kidney_cells = 1.47e07 #cells/g https://doi.org/10.1038/s41598-024-53270-2
kidney_cells_total <- kidney_cells* (1000*VKiT)
kidney_protein_total <- kidney_protein_per_gram* (1000*VKiT) #mg
ClKFT <- ClKFT_unscaled * kidney_protein_total #uL/min for the whole kidney
# Uptake for the whole kidney tissue
kKFKT <- (60*ClKFT)/1e06 #L/h
kFKT <- PeffK * AK * n
#Oatp kidney
VmK_Oatp_in_vitro <- 9.3 #nmol/mg protein/min (Weaver et al. 2010)
VmK_Oatp_scaled <- 60*VmK_Oatp_in_vitro*MW*kidney_protein_total/1000  #physiologically scaled to in vivo, ug/h
VmK_Oatp <- VmK_Oatp_scaled*RAFOatp_k #in vivo value, in  ug/h
KmK_Oatp=  126.4*MW# [umol/L] * g/mol  --> ug/L, from Weaver et al. (2010)
#oat1 kidney
VmK_Oat1_in_vitro= 2.6 #nmol/mg protein/min (Weaver et al. 2010)
VmK_Oat1_scaled = 60*VmK_Oat1_in_vitro*MW*kidney_protein_total/1000 #physiologically scaled to in vivo, ug/h
VmK_Oat1= VmK_Oat1_scaled*RAFOat1 #in vivo value, in   ug/h
KmK_Oat1= 43.2 * MW #umol/L (Weaver et al. 2010) --> ug/L
#oat3 kidney
VmK_Oat3_in_vitro= 3.8 #nmol/mg protein/min  (Weaver et al. 2010)
VmK_Oat3_scaled = 60*VmK_Oat3_in_vitro*MW*kidney_protein_total/1000 #physiologically scaled to in vivo, ug/L/h
VmK_Oat3 = VmK_Oat3_scaled*RAFOat3 #in vivo value, in   ug/h
KmK_Oat3= 65.7 * MW #umol/L (Weaver et al. 2010) --> ug/L
#Liver
liver_protein_per_rat <- 1000*(1.52+1.53+1.52)/3#mg of protein per rat  (Addis 1936)
rat_weight_addis <- 200 #g, average rat weight in Addis, 1936
rat_liver_weight_addis <- rat_weight_addis*0.0366 # liver fraction to BW, Brown (1997)
liver_protein_per_gram <- liver_protein_per_rat/rat_liver_weight_addis #mg or protein/g liver
liver_cells = 117*10^6 #hepatocytes per g of liver (Sohlenius-Sternbeck et al. 2006) (2e09 cells: https://bionumbers.hms.harvard.edu/bionumber.aspx?s=n&v=4&id=110895)
ClLFT <- ClLFT_unscaled*(liver_cells/(10^6))*(VLiT*1000) #uL/min for the whole liver
kLFLT <-  (60*ClLFT)/1e06 #L/h
# oatp-liver
VmL_Oatp_in_vitro= 9.3 #nmol/mg protein/min  (Weaver et al. 2010)
VmL_Oatp_scaled = 60*VmL_Oatp_in_vitro*MW*liver_protein_per_gram*(VLi*1000)/1000   #physiologically scaled to in vivo, ug/h
VmL_Oatp = VmL_Oatp_scaled*RAFOatp_l #in vivo value, in  ug/h
KmL_Oatp = KmK_Oatp #same as kidney
#Ntcp liver
VmL_Ntcp_in_vitro= 3#nmol/mg protein/min   Ruggiero et al. 2021
VmL_Ntcp_scaled = 60*VmL_Ntcp_in_vitro*MW*liver_protein_per_gram*(VLi*1000)/1000   #physiologically scaled to in vivo, ug/h
VmL_Ntcp = VmL_Ntcp_scaled*RAFNtcp #in vivo value, in  ug/h
KmL_Ntcp= 20 * MW #umol/L, Ruggiero et al. 2021 --> ug/L
#Muscle
muscle_cells= NA
Cmedium_M = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
muscle_protein <- 158.45 #mg/g muscle (protein data from Cheek et al.,1971 and muscle mass from Caster et al.,1956)
muscle_protein_tot <- muscle_protein * (VMuT*1000)
ClMFT <- ClMFT_unscaled * muscle_protein_tot#uL/min for the whole muscle comp
kMFMT <-  (60*ClMFT)/1e06 #L/h
#Intestine
intestine_cells = 93.1 * 2.365e6 # https://doi.org/10.1152/ajpgi.00290.2013 cells per crypt Figure 3B, number of crypts: Figure 1, https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1271340/ (mean value of rat 300 and 400 g)
Cmedium_G = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
intestine_protein <- muscle_protein#NA#5034
intestine_protein_total <- intestine_protein*(1000*VInT)
ClINFT <- ClINFT_unscaled *intestine_protein_total#uL/min for the whole gut compartment
kINFINT <-  (60*ClINFT)/1e06 #L/h
kabIN <- (kabs * AInL)*1000 #L/h
#Stomach
stomach_cells = NA
Cmedium_G = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
stomach_protein <- muscle_protein#NA#5034
stomach_protein_total <- stomach_protein*(1000*VStT)
ClStFT <- ClStFT_unscaled *stomach_protein_total #uL/min for the whole gut compartment
kStFSTT <-  (60*ClStFT)/1e06 #L/h
# For identifiability reasons we assume that absorption is realised only through the intestines
#kabST <- kabs * AStL
kabST <- (kabs_st* AStL)*1000 #L/h
#Adipose
adipose_cells = NA
Cmedium_A = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
adipose_protein <- muscle_protein#NA#5034
adipose_protein_total <- adipose_protein * (1000*VAdT)
ClAFT <- ClAFT_unscaled * adipose_protein_total#uL/min
kAFAGo <-  (60*ClAFT)/1e06 #L/h
#Rest of body
RoB_cells = NA
Cmedium_R = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
RoB_protein <- muscle_protein#18456
RoB_protein_total <- RoB_protein * (1000* VReT)
ClRFT <- ClRFT_unscaled * RoB_protein_total#uL/min
kRFRT <-  (60*ClRFT)/1e06 #L/h
#Lung
Lung_protein <- muscle_protein#18456
Lung_protein_total <- Lung_protein * (1000* VReT)
ClLuFT <- ClLuFT_unscaled * Lung_protein_total#uL/min
kLuFLuT <-  (60*ClLuFT)/1e06 #L/h
#Spleen
spleen_cells = 1.76e8 #cells/g tissue https://doi.org/10.1371/journal.pone.0059602 --> Figure 5C
Cmedium_SP = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
spleen_protein <- muscle_protein#NA#5034
spleen_protein_total <- spleen_protein * (1000*VSpT)
ClSPFT <- ClSPFT_unscaled * spleen_protein_total#uL/min
kSPFSPT <-  (60*ClSPFT)/1e06 #L/h
#Heart
heart_cells = 3.3e8 #cells/g tissue  https://doi.org/10.1620/tjem.95.177
Cmedium_H = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
heart_protein <- muscle_protein#NA#5034
heart_protein_total <- heart_protein * (1000*VHtT)
ClHFT <- ClHFT_unscaled * heart_protein_total#uL/min
kHFHT <-  (60*ClHFT)/1e06 #L/h
#Brain
brain_cells = 3.3e8/1.8 #cells/g tissue https://doi.org/10.1523/JNEUROSCI.4526-04.2005 --> Table 1
Cmedium_Br = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
brain_protein <- muscle_protein#NA#5034
brain_protein_total <- brain_protein * (1000*VBrT)
ClBrFT <- ClBrFT_unscaled * brain_protein_total#uL/min
kBrFBrT <-  (60*ClBrFT)/1e06 #L/h
#Gonads
gonads_cells = 1.85e7+1.58e7 #Sertoli and Leydig cells/g tissue  https://doi.org/10.1007/BF00297504 --> Figure 2, LC and SC cells
Cmedium_T = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
gonads_protein <- muscle_protein#NA#5034
gonads_protein_total <- gonads_protein * (1000*VGoT)
ClTFT <- ClTFT_unscaled * gonads_protein_total#uL/min
kGoFGoT <-  (60*ClTFT)/1e06 #L/h
#Skin
skin_cells = NA
Cmedium_SK = 1*MW# Kimura et al. 2017 1uM umol/L -->  ug/L
skin_protein <- muscle_protein#NA#5034
skin_protein_total <- skin_protein * (1000*VSkT)
ClSKFT <- ClSKFT_unscaled * skin_protein_total#uL/min
kSKFSKT <-  (60*ClSKFT)/1e06 #L/h
return(list('VB'=VB, 'Vplasma'=Vplasma, 'VK'=VK, 'VKiB'=VKiB,
'VKiF'=VKiF, 'VKiT'=VKiT, 'VFil'=VFil,
'VLi'=VLi, 'VLiB'=VLiB, 'VLiF'=VLiF, 'VLiT'=VLiT, 'Vbile'=Vbile,
'VMu'=VMu, 'VMuB'=VMuB, 'VMuF'=VMuF, 'VMuT'=VMuT, 'VAd'=VAd, 'VAdB'=VAdB,
'VAdF'=VAdF, 'VAdT'=VAdT, 'VRe'=VRe, 'VReB'=VReB,
'VReF'=VReF, 'VReT'=VReT, 'VLy' = VLy, 'VVen' = VVen,
'VArt' = VArt, 'VLu'=VLu, 'VLuB'=VLuB, 'VLuF'=VLuF,
'VLuAF'=VLuAF, 'VLuT'=VLuT,
'VSp'=VSp, 'VSpB'=VSpB, 'VSpF'=VSpF, 'VSpT'=VSpT,
'VHt'=VHt, 'VHtB'=VHtB, 'VHtF'=VHtF, 'VHtT'=VHtT,
'VBr'=VBr, 'VBrB'=VBrB, 'VBrF'=VBrF, 'VBrT'=VBrT,
'VGo'=VGo, 'VGoB'=VGoB, 'VGoF'=VGoF, 'VGoT'=VGoT,
'VIn'=VIn, 'VInB'=VInB, 'VInF'=VInF, 'VInT'=VInT,
'VSt'=VSt, 'VStB'=VStB, 'VStF'=VStF, 'VStT'=VStT,
'VStL'=VStL, 'VInL'=VInL,
'VSk'=VSk,'VSkB'=VSkB, 'VSkF'=VSkF, 'VSkT'=VSkT,
'AK'=AK, 'AKG'=AKG, 'AL'=AL,
'AM'=AM, 'AA'=AA, 'AR'=AR, 'ALu'= ALu,
'ASP'=ASP, 'AH'=AH, 'ABr'=ABr, 'AST'= AST,
'AIN'=AIN, 'AGo'=AGo,
'ASK'= ASK,
#'PeffB'=PeffB,
'PeffK'=PeffK, 'PeffL'=PeffL,
'PeffA'=PeffA, 'PeffM'=PeffM, 'PeffR'=PeffR, 'PeffLu' = PeffLu,
'PeffSP'=PeffSP, 'PeffH'=PeffH, 'PeffBr'=PeffBr, 'PeffST' = PeffST,
'PeffIN'=PeffIN, 'PeffGo'=PeffGo,
'PeffSK' = PeffSK,
'Qcardiac'=Qcardiac, 'QBKi'=QBKi,
'QBLi'=QBLi, 'QBLitot'=QBLitot,
'QBMu'=QBMu, 'QBAd'=QBAd,
'QBRe'=QBRe, 'QBLu'=QBLu, 'Qfeces'=Qfeces, 'feces_density'=feces_density,
'Qbile'=Qbile, 'QGFR'=QGFR,'Qurine'=Qurine,
'QBSp'=QBSp, 'QBHt'=QBHt, 'QBBr'=QBBr, 'QBSt'=QBSt,
'QBIn'=QBIn, 'QGE'=QGE,
'QBGo'=QBGo,
'QBSk'=QBSk,
'CalbB_init'= CalbB_init, 'CalbKiF_init'=CalbKiF_init, 'CalbLiF_init'=CalbLiF_init,
'CalbMuF_init'=CalbMuF_init, 'CalbAdF_init'=CalbAdF_init, 'CalbReF_init'=CalbReF_init,'CalbLy_init' =CalbLy_init,
'CalbLuF_init' =CalbLuF_init, 'CalbSpF_init' =CalbSpF_init, 'CalbGoF_init' =CalbGoF_init, 'CalbHtF_init' =CalbHtF_init,
'CalbBrF_init' =CalbBrF_init, 'CalbStF_init' =CalbStF_init, 'CalbInF_init' =CalbInF_init,
'CalbSkF_init' =CalbSkF_init,
'Ca2uKT'=Ca2uKT,'CfabpKT'=CfabpKT,'CfabpLT'=CfabpLT,
'Ka'=Ka, 'Ka2u'=Ka2u, 'Kfabp'=Kfabp,
"koff_alb" = koff_alb, "koff_a2u" = koff_a2u, "koff_fabp" = koff_fabp,
"kon_alb" = kon_alb, "kon_a2u" = kon_a2u, "kon_fabp" = kon_fabp,
'ClLFT'=ClLFT, 'ClKFT'=ClKFT,
'ClMFT'=ClMFT,
'ClAFT'=ClAFT, 'ClRFT'=ClRFT, 'ClLuFT'=ClLuFT, 'ClStFT'=ClStFT,
'ClINFT'=ClINFT, 'ClSPFT'=ClSPFT, 'ClHFT'=ClHFT, 'ClBrFT'=ClBrFT,
'ClTFT'=ClTFT,
'ClSKFT'=ClSKFT,
'VmL_Oatp'=VmL_Oatp, 'KmL_Oatp'= KmL_Oatp, 'VmL_Ntcp'= VmL_Ntcp,
'KmL_Ntcp'= KmL_Ntcp,'VmK_Oatp'= VmK_Oatp,
'KmK_Oatp'=KmK_Oatp,
#'VmK_Osta'=VmK_Osta,'KmK_Osta'=KmK_Osta,
'VmK_Oat1'=VmK_Oat1, 'KmK_Oat1'=KmK_Oat1, 'KmK_Oat1'=KmK_Oat1,
'VmK_Oat3'=VmK_Oat3, 'KmK_Oat3'=KmK_Oat3,
'kKFKT'=kKFKT, 'kFKT'=kFKT,
'kLFLT'=kLFLT, 'kbileLT'=kbileLT,  'kAFAGo'=kAFAGo,
'kRFRT'=kRFRT,
'kabST'=kabST, 'kabIN'=kabIN,
'kMFMT'=kMFMT, 'kLuFLuT' =kLuFLuT, 'kSPFSPT' =kSPFSPT,
'kStFSTT' =kStFSTT, 'kINFINT' =kINFINT, 'kHFHT' =kHFHT,
'kBrFBrT' =kBrFBrT, 'kGoFGoT' =kGoFGoT,
'kSKFSKT' =kSKFSKT,
"admin.time" = admin.time, "admin.dose" = admin.dose,
"admin.type" = admin.type, "MW"=MW
))
})
}
estimated_params <- exp(fit)
BW <- 0.29  # body weight (kg)
admin.dose_per_g <- 16.56 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_g*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in hours
admin.type <- "iv"
sex <- "M"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,100,1)
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-03, atol = 1e-03))
#solution[1:100, 1:70]
rowSums(solution[, c(34:113)])
estimated_params <- exp(fit)
BW <- 0.29  # body weight (kg)
admin.dose_per_g <- 16.56 # administered dose in mg PFOA/kg BW
admin.dose <- admin.dose_per_g*BW*1e03 #ug PFOA
admin.time <- 0 # time when doses are administered, in hours
admin.type <- "iv"
sex <- "M"
user_input <- list('BW'=BW,
"admin.dose"= admin.dose,
"admin.time" = admin.time,
"admin.type" = admin.type,
"estimated_params" = estimated_params,
"sex" = sex)
params <- create.params(user_input)
inits <- create.inits(params)
events <- create.events(params)
# sample_time: a vector of time points to solve the ODEs
sample_time=seq(0,100,1)
# ode(): The solver of the ODEs
solution <- data.frame(deSolve::ode(times = sample_time,  func = ode.func,
y = inits, parms = params,
events = events,
method="lsodes",rtol = 1e-04, atol = 1e-04))
#solution[1:100, 1:70]
rowSums(solution[, c(34:113)])
